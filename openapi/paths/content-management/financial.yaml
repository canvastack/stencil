# Financial Management - Separated Platform/Tenant Endpoints
# Refactored to comply with separated endpoint architecture

# ===== PLATFORM FINANCIAL MANAGEMENT =====
# Platform-level financial operations and global analytics

/platform/financial/analytics:
  get:
    tags:
      - Platform Financial Management
    summary: "[Platform Admin] Get Platform Financial Analytics"
    description: |
      Comprehensive financial analytics across all tenants and the entire platform.
      
      **[Platform Admin]** Global financial performance monitoring and analytics.
      
      **Features:**
      - Cross-tenant revenue analytics
      - Platform-wide profitability analysis
      - Global cash flow monitoring
      - Multi-tenant comparison reports
    operationId: getPlatformFinancialAnalytics
    security:
      - bearerAuth: []
    x-permissions:
      - platform.financial.analytics
    parameters:
      - name: period
        in: query
        schema:
          type: string
          enum: [daily, weekly, monthly, quarterly, yearly]
          default: monthly
      - name: date_from
        in: query
        schema:
          type: string
          format: date
      - name: date_to
        in: query
        schema:
          type: string
          format: date
    responses:
      '200':
        description: Platform financial analytics retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      $ref: '../../components/schemas.yaml#/PlatformFinancialAnalytics'
      '401':
        $ref: '../../components/responses.yaml#/Unauthorized'
      '403':
        $ref: '../../components/responses.yaml#/Forbidden'

/platform/financial/reports:
  get:
    tags:
      - Platform Financial Management
    summary: "[Platform Admin] List Platform Financial Reports"
    description: |
      List all financial reports across all tenants.
      
      **[Platform Admin]** Global financial reporting with cross-tenant visibility.
    operationId: listPlatformFinancialReports
    security:
      - bearerAuth: []
    x-permissions:
      - platform.financial.reports.list
    parameters:
      - name: page
        in: query
        schema:
          type: integer
          minimum: 1
          default: 1
      - name: limit
        in: query
        schema:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
      - name: tenant_id
        in: query
        schema:
          type: string
          format: uuid
        description: Filter by specific tenant
    responses:
      '200':
        description: Platform financial reports retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '../../components/schemas.yaml#/FinancialReport'

  post:
    tags:
      - Platform Financial Management
    summary: "[Platform Admin] Generate Platform Financial Report"
    description: |
      Generate comprehensive financial report for platform or specific tenant.
      
      **[Platform Admin]** Create platform-level financial reports.
    operationId: generatePlatformFinancialReport
    security:
      - bearerAuth: []
    x-permissions:
      - platform.financial.reports.create
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../../components/schemas.yaml#/FinancialReportCreateInput'
    responses:
      '201':
        description: Platform financial report generated successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      $ref: '../../components/schemas.yaml#/FinancialReport'

/platform/financial/transactions:
  get:
    tags:
      - Platform Financial Management
    summary: "[Platform Admin] List All Platform Transactions"
    description: |
      View all financial transactions across all tenants.
      
      **[Platform Admin]** Global transaction monitoring and oversight.
    operationId: listPlatformTransactions
    security:
      - bearerAuth: []
    x-permissions:
      - platform.financial.transactions.list
    parameters:
      - name: page
        in: query
        schema:
          type: integer
          minimum: 1
          default: 1
      - name: limit
        in: query
        schema:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
      - name: tenant_id
        in: query
        schema:
          type: string
          format: uuid
        description: Filter by specific tenant
      - name: transaction_type
        in: query
        schema:
          type: string
          enum: [income, expense, transfer, adjustment]
    responses:
      '200':
        description: Platform transactions retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '../../components/schemas.yaml#/FinancialTransaction'

/platform/financial/transactions/{transactionId}:
  get:
    tags:
      - Platform Financial Management
    summary: "[Platform Admin] Get Platform Transaction Details"
    description: |
      Get detailed information about any transaction across all tenants.
      
      **[Platform Admin]** Global transaction monitoring and oversight.
    operationId: getPlatformTransaction
    security:
      - bearerAuth: []
    x-permissions:
      - platform.financial.transactions.read
    parameters:
      - name: transactionId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '200':
        description: Platform transaction details retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      $ref: '../../components/schemas.yaml#/FinancialTransaction'

/platform/financial/transactions/{transactionId}/audit-review:
  post:
    tags:
      - Platform Financial Management
    summary: "[Platform Admin] Add Audit Review to Transaction"
    description: |
      Add platform-level audit review and compliance notes to any transaction.
      
      **[Platform Admin]** Audit trail and compliance oversight.
    operationId: auditReviewPlatformTransaction
    security:
      - bearerAuth: []
    x-permissions:
      - platform.financial.transactions.audit
    parameters:
      - name: transactionId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required:
              - review_notes
            properties:
              review_notes:
                type: string
                description: Platform audit review notes
              compliance_status:
                type: string
                enum: [compliant, non_compliant, requires_attention]
                default: compliant
    responses:
      '200':
        description: Audit review added successfully
        content:
          application/json:
            schema:
              $ref: '../../components/schemas.yaml#/SuccessResponse'

/platform/financial/reports/{reportId}:
  get:
    tags:
      - Platform Financial Management
    summary: "[Platform Admin] Get Platform Report Details"
    description: |
      Get detailed platform financial report with complete data.
      
      **[Platform Admin]** Access any financial report across all tenants.
    operationId: getPlatformFinancialReport
    security:
      - bearerAuth: []
    x-permissions:
      - platform.financial.reports.read
    parameters:
      - name: reportId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '200':
        description: Platform report retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      $ref: '../../components/schemas.yaml#/FinancialReport'

  delete:
    tags:
      - Platform Financial Management
    summary: "[Platform Admin] Delete Platform Financial Report"
    description: |
      Archive/delete financial report with audit compliance.
      
      **[Platform Admin]** Platform-level report management.
    operationId: deletePlatformFinancialReport
    security:
      - bearerAuth: []
    x-permissions:
      - platform.financial.reports.delete
    parameters:
      - name: reportId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '200':
        description: Platform report deleted successfully
        content:
          application/json:
            schema:
              $ref: '../../components/schemas.yaml#/SuccessResponse'

/platform/financial/reports/{reportId}/export:
  get:
    tags:
      - Platform Financial Management
    summary: "[Platform Admin] Export Platform Financial Report"
    description: |
      Export platform financial report in specified format (PDF, Excel, CSV).
      
      **[Platform Admin]** Export reports with platform-level data access.
    operationId: exportPlatformFinancialReport
    security:
      - bearerAuth: []
    x-permissions:
      - platform.financial.reports.export
    parameters:
      - name: reportId
        in: path
        required: true
        schema:
          type: string
          format: uuid
      - name: format
        in: query
        required: true
        schema:
          type: string
          enum: [pdf, excel, csv]
          default: pdf
    responses:
      '200':
        description: Report exported successfully
        content:
          application/pdf:
            schema:
              type: string
              format: binary
          application/vnd.openxmlformats-officedocument.spreadsheetml.sheet:
            schema:
              type: string
              format: binary
          text/csv:
            schema:
              type: string
              format: binary

/platform/financial/budgets:
  get:
    tags:
      - Platform Financial Management
    summary: "[Platform Admin] List All Platform Budgets"
    description: |
      List budget plans across all tenants for platform oversight.
      
      **[Platform Admin]** Global budget monitoring and compliance.
    operationId: listPlatformBudgets
    security:
      - bearerAuth: []
    x-permissions:
      - platform.financial.budgets.list
    parameters:
      - name: page
        in: query
        schema:
          type: integer
          minimum: 1
          default: 1
      - name: limit
        in: query
        schema:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
      - name: tenant_id
        in: query
        schema:
          type: string
          format: uuid
        description: Filter by specific tenant
      - name: status
        in: query
        schema:
          type: string
          enum: [draft, submitted, approved, active, completed, cancelled]
    responses:
      '200':
        description: Platform budgets retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '../../components/schemas.yaml#/Budget'

/platform/financial/budgets/{budgetId}:
  get:
    tags:
      - Platform Financial Management
    summary: "[Platform Admin] Get Platform Budget Details"
    description: |
      Get detailed budget information for platform oversight.
      
      **[Platform Admin]** Access any tenant budget for compliance review.
    operationId: getPlatformBudget
    security:
      - bearerAuth: []
    x-permissions:
      - platform.financial.budgets.read
    parameters:
      - name: budgetId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '200':
        description: Platform budget details retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      $ref: '../../components/schemas.yaml#/Budget'

/platform/financial/analytics/dashboard:
  get:
    tags:
      - Platform Financial Management
    summary: "[Platform Admin] Get Platform Financial Dashboard"
    description: |
      Comprehensive platform-wide financial analytics and KPI dashboard.
      
      **[Platform Admin]** Global financial performance monitoring across all tenants.
    operationId: getPlatformFinancialDashboard
    security:
      - bearerAuth: []
    x-permissions:
      - platform.financial.analytics.dashboard
    parameters:
      - name: period
        in: query
        schema:
          type: string
          enum: [daily, weekly, monthly, quarterly, yearly]
          default: monthly
      - name: date_from
        in: query
        schema:
          type: string
          format: date
      - name: date_to
        in: query
        schema:
          type: string
          format: date
      - name: tenant_filter
        in: query
        schema:
          type: array
          items:
            type: string
            format: uuid
        description: Filter by specific tenants
    responses:
      '200':
        description: Platform financial dashboard retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      $ref: '../../components/schemas.yaml#/PlatformFinancialDashboard'

/platform/financial/analytics/cash-flow:
  get:
    tags:
      - Platform Financial Management
    summary: "[Platform Admin] Get Platform Cash Flow Analytics"
    description: |
      Platform-wide cash flow analysis and projections across all tenants.
      
      **[Platform Admin]** Global cash flow monitoring and forecasting.
    operationId: getPlatformCashFlowAnalytics
    security:
      - bearerAuth: []
    x-permissions:
      - platform.financial.analytics.cashflow
    parameters:
      - name: months
        in: query
        schema:
          type: integer
          minimum: 1
          maximum: 24
          default: 12
      - name: include_projections
        in: query
        schema:
          type: boolean
          default: true
      - name: tenant_filter
        in: query
        schema:
          type: array
          items:
            type: string
            format: uuid
    responses:
      '200':
        description: Platform cash flow analytics retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      $ref: '../../components/schemas.yaml#/PlatformCashFlowAnalytics'

/platform/financial/analytics/profitability:
  get:
    tags:
      - Platform Financial Management
    summary: "[Platform Admin] Get Platform Profitability Analytics"
    description: |
      Platform-wide profitability analysis across all tenants and business segments.
      
      **[Platform Admin]** Global profitability monitoring and performance analysis.
    operationId: getPlatformProfitabilityAnalytics
    security:
      - bearerAuth: []
    x-permissions:
      - platform.financial.analytics.profitability
    parameters:
      - name: group_by
        in: query
        schema:
          type: string
          enum: [tenant, project, customer, service_type, month]
          default: tenant
      - name: date_from
        in: query
        schema:
          type: string
          format: date
      - name: date_to
        in: query
        schema:
          type: string
          format: date
      - name: min_margin
        in: query
        schema:
          type: number
          format: decimal
    responses:
      '200':
        description: Platform profitability analytics retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      $ref: '../../components/schemas.yaml#/PlatformProfitabilityAnalytics'

/platform/financial/transactions/bulk-import:
  post:
    tags:
      - Platform Financial Management
    summary: "[Platform Admin] Bulk Import Transactions - Platform Level"
    description: |
      Platform-level bulk import of financial transactions across tenants.
      
      **[Platform Admin]** Import transactions with cross-tenant capabilities.
    operationId: bulkImportPlatformTransactions
    security:
      - bearerAuth: []
    x-permissions:
      - platform.financial.transactions.bulk_import
    requestBody:
      required: true
      content:
        multipart/form-data:
          schema:
            type: object
            required:
              - file
            properties:
              file:
                type: string
                format: binary
                description: CSV or Excel file containing transaction data
              target_tenant_id:
                type: string
                format: uuid
                description: Target tenant for imported transactions (required for platform import)
              validate_only:
                type: boolean
                default: false
              skip_duplicates:
                type: boolean
                default: true
    responses:
      '200':
        description: Platform bulk import completed successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      $ref: '../../components/schemas.yaml#/BulkImportResult'

/platform/financial/reports/bulk-generate:
  post:
    tags:
      - Platform Financial Management
    summary: "[Platform Admin] Bulk Generate Platform Reports"
    description: |
      Generate multiple platform-level financial reports across tenants.
      
      **[Platform Admin]** Batch report generation with cross-tenant capabilities.
    operationId: bulkGeneratePlatformReports
    security:
      - bearerAuth: []
    x-permissions:
      - platform.financial.reports.bulk_generate
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required:
              - reports
            properties:
              reports:
                type: array
                items:
                  $ref: '../../components/schemas.yaml#/FinancialReportCreateInput'
                minItems: 1
                maxItems: 20
    responses:
      '202':
        description: Platform bulk report generation started
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      $ref: '../../components/schemas.yaml#/BulkGenerationResult'

# ===== TENANT FINANCIAL MANAGEMENT =====
# Tenant-scoped financial operations and business analytics

/tenant/financial/dashboard:
  get:
    tags:
      - Tenant Financial Management
    summary: "[Tenant Operation] Get Tenant Financial Dashboard"
    description: |
      Comprehensive financial dashboard for tenant business operations.
      
      **[Tenant Operation]** Tenant-specific financial overview and key metrics.
      
      **Features:**
      - Tenant revenue and expense tracking
      - Business profitability analysis
      - Cash flow monitoring
      - Project-based financial reporting
    operationId: getTenantFinancialDashboard
    security:
      - bearerAuth: []
      - tenantHeader: []
    x-permissions:
      - tenant.financial.dashboard
    parameters:
      - name: period
        in: query
        schema:
          type: string
          enum: [daily, weekly, monthly, quarterly, yearly]
          default: monthly
    responses:
      '200':
        description: Tenant financial dashboard retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      $ref: '../../components/schemas.yaml#/FinancialDashboard'
      '401':
        $ref: '../../components/responses.yaml#/Unauthorized'
      '403':
        $ref: '../../components/responses.yaml#/Forbidden'

/tenant/financial/transactions:
  get:
    tags:
      - Tenant Financial Management
    summary: "[Tenant Operation] List Tenant Transactions"
    description: |
      Retrieve paginated list of financial transactions with advanced filtering and analytics for tenant business operations.
      
      **[Tenant Operation]** Tenant-scoped transaction management and tracking.
      
      **Features:**
      - Search by description, reference number
      - Filter by type, status, date range, project, customer, vendor
      - Sort by multiple fields with performance optimization  
      - Real-time balance calculations
      - Export functionality (CSV, Excel, PDF)
      - Tenant-scoped results with strict isolation
    operationId: listTenantTransactions
    security:
      - bearerAuth: []
      - tenantHeader: []
    x-permissions:
      - tenant.financial.transactions.list
    parameters:
      - name: page
        in: query
        schema:
          type: integer
          minimum: 1
          default: 1
      - name: limit
        in: query
        schema:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
      - name: search
        in: query
        description: Search in description, reference number
        schema:
          type: string
          maxLength: 255
        example: "etching service"
      - name: transaction_type
        in: query
        description: Filter by transaction type
        schema:
          type: string
          enum: [income, expense, transfer, adjustment]
        example: "income"
      - name: status
        in: query
        description: Filter by transaction status
        schema:
          type: string
          enum: [pending, approved, rejected, cancelled, completed]
        example: "approved"
      - name: date_from
        in: query
        description: Filter transactions from this date
        schema:
          type: string
          format: date
        example: "2025-11-01"
      - name: date_to
        in: query
        description: Filter transactions to this date
        schema:
          type: string
          format: date
        example: "2025-11-30"
      - name: project_id
        in: query
        description: Filter by project
        schema:
          type: string
          format: uuid
        example: "550e8400-e29b-41d4-a716-446655440000"
      - name: customer_id
        in: query
        description: Filter by customer
        schema:
          type: string
          format: uuid
        example: "123e4567-e89b-12d3-a456-426614174000"
      - name: vendor_id
        in: query
        description: Filter by vendor
        schema:
          type: string
          format: uuid
        example: "987fcdeb-51d2-43b1-9876-543210fedcba"
      - name: amount_min
        in: query
        description: Minimum transaction amount
        schema:
          type: number
          format: decimal
        example: 100000.00
      - name: amount_max
        in: query
        description: Maximum transaction amount
        schema:
          type: number
          format: decimal
        example: 10000000.00
    responses:
      '200':
        description: Tenant transactions retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '../../components/schemas.yaml#/FinancialTransaction'

  post:
    tags:
      - Tenant Financial Management
    summary: "[Tenant Operation] Create Tenant Transaction"
    description: |
      Create new financial transaction with automatic accounting integration within tenant business context.
      
      **[Tenant Operation]** Record business transactions and financial activities.
      
      **Business Features:**
      - Automatic currency conversion and tax calculations
      - Project and customer/vendor linking
      - Document attachment support
      - Approval workflow integration
      - Real-time balance updates
      - Audit trail creation
    operationId: createTenantTransaction
    security:
      - bearerAuth: []
      - tenantHeader: []
    x-permissions:
      - tenant.financial.transactions.create
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../../components/schemas.yaml#/FinancialTransactionCreateInput'
    responses:
      '201':
        description: Tenant transaction created successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      $ref: '../../components/schemas.yaml#/FinancialTransaction'

/tenant/financial/transactions/{transactionId}:
  get:
    tags:
      - Tenant Financial Management
    summary: "[Tenant Operation] Get Tenant Transaction Details"
    description: |
      Get detailed information about specific transaction within tenant.
      
      **[Tenant Operation]** View transaction details for business operations.
    operationId: getTenantTransaction
    security:
      - bearerAuth: []
      - tenantHeader: []
    x-permissions:
      - tenant.financial.transactions.read
    parameters:
      - name: transactionId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '200':
        description: Tenant transaction details retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      $ref: '../../components/schemas.yaml#/FinancialTransaction'
      '404':
        $ref: '../../components/responses.yaml#/NotFound'

/tenant/financial/transactions/{transactionId}/approve:
  post:
    tags:
      - Tenant Financial Management
    summary: "[Tenant Operation] Approve Tenant Transaction"
    description: |
      Approve pending financial transaction within tenant business context.
      
      **[Tenant Operation]** Transaction approval workflow for business operations.
    operationId: approveTenantTransaction
    security:
      - bearerAuth: []
      - tenantHeader: []
    x-permissions:
      - tenant.financial.transactions.approve
    parameters:
      - name: transactionId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    requestBody:
      required: false
      content:
        application/json:
          schema:
            type: object
            properties:
              approval_notes:
                type: string
                description: Approval notes
                example: "Approved after verification of receipts"
    responses:
      '200':
        description: Tenant transaction approved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      $ref: '../../components/schemas.yaml#/FinancialTransaction'

/tenant/financial/transactions/{transactionId}/reject:
  post:
    tags:
      - Tenant Financial Management
    summary: "[Tenant Operation] Reject Tenant Transaction"
    description: |
      Reject pending financial transaction with reason within tenant business context.
      
      **[Tenant Operation]** Transaction rejection workflow for business operations.
    operationId: rejectTenantTransaction
    security:
      - bearerAuth: []
      - tenantHeader: []
    x-permissions:
      - tenant.financial.transactions.reject
    parameters:
      - name: transactionId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required:
              - reason
            properties:
              reason:
                type: string
                description: Reason for rejection
                example: "Missing receipt documentation"
              rejection_notes:
                type: string
                description: Additional rejection notes
    responses:
      '200':
        description: Tenant transaction rejected successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      $ref: '../../components/schemas.yaml#/FinancialTransaction'

  patch:
    tags:
      - Tenant Financial Management
    summary: "[Tenant Operation] Update Tenant Transaction"
    description: |
      Update transaction information within tenant business context.
      
      **[Tenant Operation]** Modify business transaction details.
    operationId: updateTenantTransaction
    security:
      - bearerAuth: []
      - tenantHeader: []
    x-permissions:
      - tenant.financial.transactions.update
    parameters:
      - name: transactionId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../../components/schemas.yaml#/FinancialTransactionUpdateInput'
    responses:
      '200':
        description: Tenant transaction updated successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      $ref: '../../components/schemas.yaml#/FinancialTransaction'

  delete:
    tags:
      - Tenant Financial Management
    summary: "[Tenant Operation] Delete Tenant Transaction"
    description: |
      Delete transaction from tenant financial records.
      
      **[Tenant Operation]** Remove transaction from business records.
    operationId: deleteTenantTransaction
    security:
      - bearerAuth: []
      - tenantHeader: []
    x-permissions:
      - tenant.financial.transactions.delete
    parameters:
      - name: transactionId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '200':
        description: Tenant transaction deleted successfully
        content:
          application/json:
            schema:
              $ref: '../../components/schemas.yaml#/SuccessResponse'

/tenant/financial/reports:
  get:
    tags:
      - Tenant Financial Management
    summary: "[Tenant Operation] List Tenant Financial Reports"
    description: |
      Retrieve paginated list of generated financial reports for tenant business operations.
      
      **[Tenant Operation]** Access tenant-specific financial reporting.
      
      **Features:**
      - Filter by report type, period, status
      - Search by report name
      - Access control based on sharing settings
      - Export status tracking
    operationId: listTenantFinancialReports
    security:
      - bearerAuth: []
      - tenantHeader: []
    x-permissions:
      - tenant.financial.reports.list
    parameters:
      - name: page
        in: query
        schema:
          type: integer
          minimum: 1
          default: 1
      - name: limit
        in: query
        schema:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
      - name: search
        in: query
        description: Search in report name
        schema:
          type: string
        example: "Monthly P&L"
      - name: report_type
        in: query
        description: Filter by report type
        schema:
          type: string
          enum: [profit_loss, balance_sheet, cash_flow, budget_variance, project_profitability, custom]
        example: "profit_loss"
      - name: status
        in: query
        description: Filter by report status
        schema:
          type: string
          enum: [generating, generated, failed, archived]
        example: "generated"
      - name: period_from
        in: query
        description: Filter reports with period starting from this date
        schema:
          type: string
          format: date
        example: "2025-11-01"
      - name: period_to
        in: query
        description: Filter reports with period ending to this date
        schema:
          type: string
          format: date
        example: "2025-11-30"
    responses:
      '200':
        description: Tenant financial reports retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '../../components/schemas.yaml#/FinancialReport'

  post:
    tags:
      - Tenant Financial Management
    summary: "[Tenant Operation] Generate Tenant Financial Report"
    description: |
      Generate financial report with specified parameters for tenant business operations.
      
      **[Tenant Operation]** Create business financial reports and analytics.
      
      **Report Types:**
      - Profit & Loss Statement
      - Balance Sheet
      - Cash Flow Statement
      - Budget Variance Report
      - Project Profitability Analysis
      - Custom Reports with filters
    operationId: generateTenantFinancialReport
    security:
      - bearerAuth: []
      - tenantHeader: []
    x-permissions:
      - tenant.financial.reports.create
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../../components/schemas.yaml#/FinancialReportCreateInput'
    responses:
      '201':
        description: Tenant financial report generated successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      $ref: '../../components/schemas.yaml#/FinancialReport'

/tenant/financial/reports/{reportId}:
  get:
    tags:
      - Tenant Financial Management
    summary: "[Tenant Operation] Get Tenant Report Details"
    description: |
      Retrieve specific financial report with complete data within tenant business context.
      
      **[Tenant Operation]** Access tenant-specific report details.
      
      **Response includes:**
      - Report metadata and generation info
      - Complete report data in JSON format
      - Executive summary and insights
      - Export download links
    operationId: getTenantFinancialReport
    security:
      - bearerAuth: []
      - tenantHeader: []
    x-permissions:
      - tenant.financial.reports.read
    parameters:
      - name: reportId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '200':
        description: Tenant report details retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      $ref: '../../components/schemas.yaml#/FinancialReport'
      '404':
        $ref: '../../components/responses.yaml#/NotFound'

  delete:
    tags:
      - Tenant Financial Management
    summary: "[Tenant Operation] Delete Tenant Report"
    description: |
      Archive/delete financial report within tenant business context.
      
      **[Tenant Operation]** Remove report from tenant records.
    operationId: deleteTenantFinancialReport
    security:
      - bearerAuth: []
      - tenantHeader: []
    x-permissions:
      - tenant.financial.reports.delete
    parameters:
      - name: reportId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '200':
        description: Tenant report deleted successfully
        content:
          application/json:
            schema:
              $ref: '../../components/schemas.yaml#/SuccessResponse'

/tenant/financial/reports/{reportId}/export:
  get:
    tags:
      - Tenant Financial Management
    summary: "[Tenant Operation] Export Tenant Report"
    description: |
      Export tenant financial report in specified format (PDF, Excel, CSV).
      
      **[Tenant Operation]** Export business reports for tenant use.
    operationId: exportTenantFinancialReport
    security:
      - bearerAuth: []
      - tenantHeader: []
    x-permissions:
      - tenant.financial.reports.export
    parameters:
      - name: reportId
        in: path
        required: true
        schema:
          type: string
          format: uuid
      - name: format
        in: query
        required: true
        schema:
          type: string
          enum: [pdf, excel, csv]
          default: pdf
    responses:
      '200':
        description: Report exported successfully
        content:
          application/pdf:
            schema:
              type: string
              format: binary
          application/vnd.openxmlformats-officedocument.spreadsheetml.sheet:
            schema:
              type: string
              format: binary
          text/csv:
            schema:
              type: string
              format: binary

/tenant/financial/budgets:
  get:
    tags:
      - Tenant Financial Management
    summary: "[Tenant Operation] List Tenant Budgets"
    description: |
      Retrieve paginated list of budget plans with variance analysis for tenant business operations.
      
      **[Tenant Operation]** Manage tenant budget planning and tracking.
      
      **Features:**
      - Filter by budget type, fiscal year, status
      - Sort by creation date, budget amounts
      - Real-time variance calculations
      - Status-based access control
    operationId: listTenantBudgets
    security:
      - bearerAuth: []
      - tenantHeader: []
    x-permissions:
      - tenant.financial.budgets.list
    parameters:
      - name: page
        in: query
        schema:
          type: integer
          minimum: 1
          default: 1
      - name: budget_type
        in: query
        description: Filter by budget type
        schema:
          type: string
          enum: [annual, quarterly, monthly, project, department]
        example: "annual"
      - name: fiscal_year
        in: query
        description: Filter by fiscal year
        schema:
          type: integer
        example: 2025
      - name: status
        in: query
        description: Filter by budget status
        schema:
          type: string
          enum: [draft, submitted, approved, active, completed, cancelled]
        example: "approved"
    responses:
      '200':
        description: Tenant budgets retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '../../components/schemas.yaml#/Budget'

  post:
    tags:
      - Tenant Financial Management
    summary: "[Tenant Operation] Create Tenant Budget"
    description: |
      Create new budget plan with detailed breakdown and approval workflow for tenant business operations.
      
      **[Tenant Operation]** Create business budget and financial planning.
      
      **Budget Creation Features:**
      - Hierarchical budget breakdown by category
      - Template-based budget creation
      - Validation against historical data
      - Automatic variance alert setup
    operationId: createTenantBudget
    security:
      - bearerAuth: []
      - tenantHeader: []
    x-permissions:
      - tenant.financial.budgets.create
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../../components/schemas.yaml#/BudgetCreateInput'
    responses:
      '201':
        description: Tenant budget created successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      $ref: '../../components/schemas.yaml#/Budget'

/tenant/financial/budgets/{budgetId}:
  get:
    tags:
      - Tenant Financial Management
    summary: "[Tenant Operation] Get Tenant Budget Details"
    description: |
      Retrieve detailed budget plan with real-time variance analysis within tenant business context.
      
      **[Tenant Operation]** Access specific budget details for business planning.
      
      **Includes:**
      - Complete budget breakdown
      - Actual vs. budgeted amounts
      - Variance analysis and alerts
      - Approval history and notes
    operationId: getTenantBudget
    security:
      - bearerAuth: []
      - tenantHeader: []
    x-permissions:
      - tenant.financial.budgets.read
    parameters:
      - name: budgetId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '200':
        description: Tenant budget details retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      $ref: '../../components/schemas.yaml#/Budget'
      '404':
        $ref: '../../components/responses.yaml#/NotFound'

  patch:
    tags:
      - Tenant Financial Management
    summary: "[Tenant Operation] Update Tenant Budget"
    description: |
      Update budget plan within tenant business context (only draft and submitted status allowed).
      
      **[Tenant Operation]** Modify business budget and financial planning.
      
      **Business Rules:**
      - Only pending budgets can be fully modified
      - Approved budgets have limited update fields
      - All changes are logged in audit trail
    operationId: updateTenantBudget
    security:
      - bearerAuth: []
      - tenantHeader: []
    x-permissions:
      - tenant.financial.budgets.update
    parameters:
      - name: budgetId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../../components/schemas.yaml#/BudgetUpdateInput'
    responses:
      '200':
        description: Tenant budget updated successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      $ref: '../../components/schemas.yaml#/Budget'

  delete:
    tags:
      - Tenant Financial Management
    summary: "[Tenant Operation] Delete Tenant Budget"
    description: |
      Delete/archive budget plan within tenant business context.
      
      **[Tenant Operation]** Remove budget from business planning.
    operationId: deleteTenantBudget
    security:
      - bearerAuth: []
      - tenantHeader: []
    x-permissions:
      - tenant.financial.budgets.delete
    parameters:
      - name: budgetId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    responses:
      '200':
        description: Tenant budget deleted successfully
        content:
          application/json:
            schema:
              $ref: '../../components/schemas.yaml#/SuccessResponse'

/tenant/financial/budgets/{budgetId}/submit:
  post:
    tags:
      - Tenant Financial Management
    summary: "[Tenant Operation] Submit Tenant Budget for Approval"
    description: |
      Submit budget plan for approval workflow within tenant business context.
      
      **[Tenant Operation]** Submit business budget for management review.
    operationId: submitTenantBudget
    security:
      - bearerAuth: []
      - tenantHeader: []
    x-permissions:
      - tenant.financial.budgets.submit
    parameters:
      - name: budgetId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    requestBody:
      required: false
      content:
        application/json:
          schema:
            type: object
            properties:
              submission_notes:
                type: string
                description: Budget submission notes
                example: "Budget ready for Q1 2026 approval"
    responses:
      '200':
        description: Tenant budget submitted successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      $ref: '../../components/schemas.yaml#/Budget'

/tenant/financial/budgets/{budgetId}/approve:
  post:
    tags:
      - Tenant Financial Management
    summary: "[Tenant Operation] Approve Tenant Budget"
    description: |
      Approve submitted budget plan within tenant business context.
      
      **[Tenant Operation]** Approve business budget and activate for use.
    operationId: approveTenantBudget
    security:
      - bearerAuth: []
      - tenantHeader: []
    x-permissions:
      - tenant.financial.budgets.approve
    parameters:
      - name: budgetId
        in: path
        required: true
        schema:
          type: string
          format: uuid
    requestBody:
      required: false
      content:
        application/json:
          schema:
            type: object
            properties:
              approval_notes:
                type: string
                description: Budget approval notes
                example: "Budget approved with recommended adjustments"
    responses:
      '200':
        description: Tenant budget approved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      $ref: '../../components/schemas.yaml#/Budget'

/tenant/financial/transactions/bulk-import:
  post:
    tags:
      - Tenant Financial Management
    summary: "[Tenant Operation] Bulk Import Tenant Transactions"
    description: |
      Import multiple financial transactions from CSV/Excel within tenant business context.
      
      **[Tenant Operation]** Bulk import business transactions for efficient data entry.
      
      **Import Features:**
      - CSV and Excel file support
      - Data validation and error reporting
      - Duplicate detection and handling
      - Progress tracking for large imports
      - Rollback capability on errors
      - Tenant-scoped data isolation
    operationId: bulkImportTenantTransactions
    security:
      - bearerAuth: []
      - tenantHeader: []
    x-permissions:
      - tenant.financial.transactions.bulk_import
    requestBody:
      required: true
      content:
        multipart/form-data:
          schema:
            type: object
            required:
              - file
            properties:
              file:
                type: string
                format: binary
                description: CSV or Excel file containing transaction data
              validate_only:
                type: boolean
                default: false
                description: Only validate data without importing
              skip_duplicates:
                type: boolean
                default: true
                description: Skip duplicate transactions based on reference number
    responses:
      '200':
        description: Tenant transactions imported successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        total_rows:
                          type: integer
                          example: 150
                        imported_count:
                          type: integer
                          example: 148
                        skipped_count:
                          type: integer
                          example: 2
                        error_count:
                          type: integer
                          example: 0
                        errors:
                          type: array
                          items:
                            type: object
                            properties:
                              row:
                                type: integer
                              error:
                                type: string
                        import_id:
                          type: string
                          format: uuid
                          description: Import batch ID for tracking
      '400':
        $ref: '../../components/responses.yaml#/ValidationError'
      '401':
        $ref: '../../components/responses.yaml#/Unauthorized'
      '403':
        $ref: '../../components/responses.yaml#/Forbidden'
      '413':
        description: File too large
        content:
          application/json:
            schema:
              $ref: '../../components/responses.yaml#/ErrorResponse'
      '500':
        $ref: '../../components/responses.yaml#/ServerError'

/tenant/financial/reports/bulk-generate:
  post:
    tags:
      - Tenant Financial Management
    summary: "[Tenant Operation] Bulk Generate Tenant Reports"
    description: |
      Generate multiple financial reports in batch for different periods or types within tenant business context.
      
      **[Tenant Operation]** Batch report generation for business analytics and planning.
      
      **Features:**
      - Generate multiple reports simultaneously
      - Different report types and periods
      - Progress tracking and status monitoring
      - Automatic export format selection
    operationId: bulkGenerateTenantReports
    security:
      - bearerAuth: []
      - tenantHeader: []
    x-permissions:
      - tenant.financial.reports.bulk_generate
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required:
              - reports
            properties:
              reports:
                type: array
                items:
                  $ref: '../../components/schemas.yaml#/FinancialReportCreateInput'
                description: List of reports to generate
                minItems: 1
                maxItems: 10
    responses:
      '202':
        description: Tenant bulk report generation started
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        batch_id:
                          type: string
                          format: uuid
                          description: Batch generation ID for tracking
                        total_reports:
                          type: integer
                          example: 5
                        estimated_completion:
                          type: string
                          format: date-time
                          description: Estimated completion time
                    message:
                      type: string
                      example: "Bulk report generation started successfully"
      '400':
        $ref: '../../components/responses.yaml#/ValidationError'
      '401':
        $ref: '../../components/responses.yaml#/Unauthorized'
      '403':
        $ref: '../../components/responses.yaml#/Forbidden'
      '500':
        $ref: '../../components/responses.yaml#/ServerError'

/tenant/financial/analytics/cash-flow:
  get:
    tags:
      - Tenant Financial Management
    summary: "[Tenant Operation] Get Tenant Cash Flow Analytics"
    description: |
      Detailed cash flow analysis with projections for tenant business operations.
      
      **[Tenant Operation]** Monitor tenant cash flow and liquidity with future projections.
      
      **Features:**
      - Monthly cash flow tracking
      - Future cash flow projections
      - Running balance calculations
      - Cash in vs cash out analysis
    operationId: getTenantCashFlowAnalytics
    security:
      - bearerAuth: []
      - tenantHeader: []
    x-permissions:
      - tenant.financial.analytics.cashflow
    parameters:
      - name: months
        in: query
        description: Number of months to analyze
        schema:
          type: integer
          minimum: 1
          maximum: 24
          default: 12
        example: 12
      - name: include_projections
        in: query
        description: Include future cash flow projections
        schema:
          type: boolean
          default: true
        example: true
    responses:
      '200':
        description: Tenant cash flow analytics retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        monthly_cash_flow:
                          type: array
                          items:
                            type: object
                            properties:
                              month:
                                type: string
                                format: date
                              cash_in:
                                type: number
                                format: decimal
                              cash_out:
                                type: number
                                format: decimal
                              net_cash_flow:
                                type: number
                                format: decimal
                              running_balance:
                                type: number
                                format: decimal
                        projections:
                          type: array
                          items:
                            type: object
                            properties:
                              month:
                                type: string
                                format: date
                              projected_cash_in:
                                type: number
                                format: decimal
                              projected_cash_out:
                                type: number
                                format: decimal
                              projected_balance:
                                type: number
                                format: decimal
      '401':
        $ref: '../../components/responses.yaml#/Unauthorized'
      '403':
        $ref: '../../components/responses.yaml#/Forbidden'
      '500':
        $ref: '../../components/responses.yaml#/ServerError'

/tenant/financial/analytics/profitability:
  get:
    tags:
      - Tenant Financial Management
    summary: "[Tenant Operation] Get Tenant Profitability Analytics"
    description: |
      Comprehensive profitability analysis for tenant business operations.
      
      **[Tenant Operation]** Analyze tenant business profitability and performance.
      
      **Features:**
      - Group by project, customer, service type, or month
      - Profit margin analysis with filtering
      - Revenue and cost breakdown
      - Performance comparison across segments
    operationId: getTenantProfitabilityAnalytics
    security:
      - bearerAuth: []
      - tenantHeader: []
    x-permissions:
      - tenant.financial.analytics.profitability
    parameters:
      - name: group_by
        in: query
        description: Group profitability analysis by
        schema:
          type: string
          enum: [project, customer, service_type, month]
          default: project
        example: "project"
      - name: date_from
        in: query
        description: Analysis start date
        schema:
          type: string
          format: date
        example: "2025-11-01"
      - name: date_to
        in: query
        description: Analysis end date
        schema:
          type: string
          format: date
        example: "2025-11-30"
      - name: min_margin
        in: query
        description: Minimum profit margin filter (percentage)
        schema:
          type: number
          format: decimal
        example: 20.0
    responses:
      '200':
        description: Tenant profitability analytics retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        overall_metrics:
                          type: object
                          properties:
                            total_revenue:
                              type: number
                              format: decimal
                            total_cost:
                              type: number
                              format: decimal
                            gross_profit:
                              type: number
                              format: decimal
                            average_margin:
                              type: number
                              format: decimal
                        profitability_breakdown:
                          type: array
                          items:
                            type: object
                            properties:
                              group_name:
                                type: string
                              revenue:
                                type: number
                                format: decimal
                              cost:
                                type: number
                                format: decimal
                              profit:
                                type: number
                                format: decimal
                              margin_percentage:
                                type: number
                                format: decimal
      '400':
        $ref: '../../components/responses.yaml#/ValidationError'
      '401':
        $ref: '../../components/responses.yaml#/Unauthorized'
      '403':
        $ref: '../../components/responses.yaml#/Forbidden'
      '500':
        $ref: '../../components/responses.yaml#/ServerError'

/tenant/financial/analytics/dashboard:
  get:
    tags:
      - Tenant Financial Management
    summary: "[Tenant Operation] Get Tenant Financial Analytics Dashboard"
    description: |
      Comprehensive financial dashboard data with KPIs and trends for tenant business.
      
      **[Tenant Operation]** Tenant business financial performance monitoring.
      
      **Dashboard Features:**
      - Revenue and expense summaries
      - Profit margins and growth trends
      - Top customers and revenue sources
      - Expense breakdown and cost analysis
      - Cash flow indicators
      - Budget vs. actual comparisons
    operationId: getTenantFinancialDashboard
    security:
      - bearerAuth: []
      - tenantHeader: []
    x-permissions:
      - tenant.financial.analytics.dashboard
    parameters:
      - name: period
        in: query
        description: Analysis period
        schema:
          type: string
          enum: [today, week, month, quarter, year, custom]
          default: month
        example: "month"
      - name: date_from
        in: query
        description: Custom period start date (required if period=custom)
        schema:
          type: string
          format: date
        example: "2025-11-01"
      - name: date_to
        in: query
        description: Custom period end date (required if period=custom)
        schema:
          type: string
          format: date
        example: "2025-11-30"
      - name: compare_previous
        in: query
        description: Include comparison with previous period
        schema:
          type: boolean
          default: true
        example: true
    responses:
      '200':
        description: Tenant financial dashboard analytics retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../../components/schemas.yaml#/SuccessResponse'
                - type: object
                  properties:
                    data:
                      $ref: '../../components/schemas.yaml#/FinancialAnalytics'
      '400':
        $ref: '../../components/responses.yaml#/ValidationError'
      '401':
        $ref: '../../components/responses.yaml#/Unauthorized'
      '403':
        $ref: '../../components/responses.yaml#/Forbidden'
      '500':
        $ref: '../../components/responses.yaml#/ServerError'