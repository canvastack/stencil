# Inventory Management API Path Items
# This file contains only path items (no openapi/info/paths wrapper)

# Inventory Dashboard & Overview
/admin/inventory:
  get:
    tags:
      - Inventory Management
    summary: Get Inventory Dashboard
    description: |
      Retrieve comprehensive inventory dashboard with items, locations, alerts, and summary statistics.
      
      **Business Features:**
      - Complete inventory overview with stock levels
      - Low stock and out-of-stock alerts
      - Location-based inventory distribution
      - Value analysis and cost tracking
      - Integration with etching business workflow
      
      **Dashboard Components:**
      - Inventory items with current stock levels
      - Storage locations and capacity utilization
      - Active alerts (low stock, expiry, quality issues)
      - Summary statistics and KPIs
      - Recent movement history
    operationId: getInventoryDashboard
    security:
      - bearerAuth: []
    x-permissions:
      - inventory.dashboard.read
    parameters:
      - $ref: '#/components/parameters/TenantHeader'
      - name: location_id
        in: query
        schema:
          type: string
          format: uuid
        description: Filter by specific location
      - name: item_type
        in: query
        schema:
          type: string
          enum: [material, consumable, tool, finished_good, work_in_progress]
        description: Filter by item type
      - name: category
        in: query
        schema:
          type: string
        description: Filter by item category
      - name: low_stock_only
        in: query
        schema:
          type: boolean
          default: false
        description: Show only items below reorder point
    responses:
      '200':
        description: Inventory dashboard retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/BaseResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/InventoryPageData'
            examples:
              ok:
                summary: Dashboard snapshot
                value:
                  success: true
                  message: "Inventory dashboard retrieved successfully"
                  data:
                    summary:
                      total_items: 450
                      total_locations: 8
                      total_inventory_value: 125750000.00
                      low_stock_alerts: 12
                      out_of_stock_count: 3
                      pending_movements: 5
                    items:
                      - id: "550e8400-e29b-41d4-a716-446655440000"
                        item_code: "MTL-BRASS-001"
                        item_name: "Brass Sheet 2mm Thickness"
                        category: "Raw Materials"
                        current_stock: 15.5
                        reorder_point: 20.0
                        unit_of_measure: "kg"
                        standard_cost: 45000.00
                    alerts:
                      - id: "660f9500-f39c-52e5-b827-557766551111"
                        alert_type: "low_stock"
                        priority: "high"
                        alert_title: "Low Stock Alert: Brass Sheet 2mm"
                        current_stock: 15.5
                        threshold_value: 20.0
                  meta:
                    timestamp: "2025-01-15T10:30:00Z"
                    tenant_id: "6ba7b810-9dad-11d1-80b4-00c04fd430c8"
                    cache_expires: "2025-01-15T10:35:00Z"
      '401':
        $ref: '#/components/responses/Unauthorized'
      '403':
        $ref: '#/components/responses/Forbidden'
      '429':
        $ref: '#/components/responses/RateLimitExceeded'
      '500':
        $ref: '#/components/responses/ServerError'

# Inventory Items Management
/admin/inventory/items:
  get:
    tags:
      - Inventory Items
    summary: List Inventory Items
    description: |
      Retrieve inventory items with filtering, search, sorting, and pagination.
      
      **Admin Features:**
      - Complete item catalog with stock levels
      - Advanced filtering by category, type, status
      - Full-text search across item details
      - Bulk operations support
      - Export capabilities (CSV, Excel)
      - Stock level monitoring and alerts
    operationId: listInventoryItems
    security:
      - bearerAuth: []
    x-permissions:
      - inventory.item.list
    parameters:
      - $ref: '#/components/parameters/TenantHeader'
      - $ref: '#/components/parameters/PageParam'
      - $ref: '#/components/parameters/PerPageParam'
      - $ref: '#/components/parameters/SortParam'
      - name: search
        in: query
        schema:
          type: string
        description: Search item code, name, or description
        example: "brass sheet"
      - name: category
        in: query
        schema:
          type: string
        description: Filter by item category
        example: "Raw Materials"
      - name: item_type
        in: query
        schema:
          type: string
          enum: [material, consumable, tool, finished_good, work_in_progress]
        description: Filter by item type
      - name: material_type
        in: query
        schema:
          type: string
        description: Filter by material type (etching-specific)
        example: "brass"
      - name: low_stock
        in: query
        schema:
          type: boolean
        description: Show only items below reorder point
      - name: out_of_stock
        in: query
        schema:
          type: boolean
        description: Show only out-of-stock items
      - name: active_only
        in: query
        schema:
          type: boolean
          default: true
        description: Show only active items
    responses:
      '200':
        description: Inventory items retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/PaginatedResponse'
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '#/components/schemas/InventoryItem'
                    meta:
                      allOf:
                        - $ref: '#/components/schemas/PaginationMeta'
                        - type: object
                          properties:
                            summary:
                              $ref: '#/components/schemas/InventorySummary'
            examples:
              ok:
                summary: Items list
                value:
                  success: true
                  data:
                    - id: "550e8400-e29b-41d4-a716-446655440000"
                      item_code: "MTL-BRASS-002"
                      item_name: "Brass Sheet 3mm Thickness"
                      item_type: "material"
                      current_stock: 30.0
                    - id: "123e4567-e89b-12d3-a456-426614174000"
                      item_code: "TOOL-ETCH-001"
                      item_name: "Etching Tool Basic"
                      item_type: "tool"
                      current_stock: 8
                  meta:
                    page: 1
                    per_page: 10
                    total: 2
      '401':
        $ref: '#/components/responses/Unauthorized'
      '403':
        $ref: '#/components/responses/Forbidden'
      '429':
        $ref: '#/components/responses/RateLimitExceeded'
      '500':
        $ref: '#/components/responses/ServerError'

  post:
    tags:
      - Inventory Items
    summary: Create Inventory Item
    description: |
      Create new inventory item with complete specifications.
      
      **Creation Features:**
      - Full item specification with etching-specific properties
      - Automatic stock initialization
      - Supplier relationship setup
      - Reorder point configuration
      - Cost and pricing setup
      - Quality control requirements
    operationId: createInventoryItem
    security:
      - bearerAuth: []
    x-permissions:
      - inventory.item.create
    parameters:
      - $ref: '#/components/parameters/TenantHeader'
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/InventoryItemCreateInput'
          examples:
            brass_material:
              summary: Create brass sheet material
              value:
                item_code: "MTL-BRASS-002"
                item_name: "Brass Sheet 3mm Thickness"
                description: "High-grade brass sheet for premium etching applications"
                category: "Raw Materials"
                subcategory: "Metals"
                item_type: "material"
                unit_of_measure: "kg"
                material_type: "Brass"
                thickness: 3.0
                minimum_stock_level: 15.0
                reorder_point: 25.0
                standard_cost: 55000.00
                is_active: true
    responses:
      '201':
        $ref: '#/components/responses/CreatedResponse'
      '400':
        $ref: '#/components/responses/ValidationError'
      '401':
        $ref: '#/components/responses/Unauthorized'
      '403':
        $ref: '#/components/responses/Forbidden'
      '409':
        $ref: '#/components/responses/Conflict'
      '500':
        $ref: '#/components/responses/ServerError'

/admin/inventory/items/{id}:
  get:
    tags:
      - Inventory Items
    summary: Get Inventory Item Details
    description: |
      Retrieve complete inventory item details including stock levels,
      movement history, supplier information, and related data.
    operationId: getInventoryItem
    security:
      - bearerAuth: []
    x-permissions:
      - inventory.item.read
    parameters:
      - $ref: '#/components/parameters/TenantHeader'
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: Inventory item ID
      - name: include
        in: query
        schema:
          type: array
          items:
            type: string
            enum: [movements, suppliers, alerts, locations]
        description: Include related data
    responses:
      '200':
        description: Inventory item retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/BaseResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/InventoryItem'
            examples:
              ok:
                summary: Item detail
                value:
                  success: true
                  data:
                    id: "550e8400-e29b-41d4-a716-446655440000"
                    item_code: "MTL-BRASS-002"
                    item_name: "Brass Sheet 3mm Thickness"
                    item_type: "material"
                    current_stock: 30.0
                    reorder_point: 25.0
      '401':
        $ref: '#/components/responses/Unauthorized'
      '403':
        $ref: '#/components/responses/Forbidden'
      '404':
        $ref: '#/components/responses/NotFound'
      '500':
        $ref: '#/components/responses/ServerError'

  put:
    tags:
      - Inventory Items
    summary: Update Inventory Item
    description: |
      Update inventory item details including specifications,
      stock parameters, and configurations.
    operationId: updateInventoryItem
    security:
      - bearerAuth: []
    x-permissions:
      - inventory.item.update
    parameters:
      - $ref: '#/components/parameters/TenantHeader'
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: Inventory item ID
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/InventoryItemUpdateInput'
          examples:
            update_item:
              summary: Update item basics
              value:
                description: "Updated description"
                reorder_point: 30.0
                minimum_stock_level: 20.0
    responses:
      '200':
        $ref: '#/components/responses/UpdatedResponse'
      '400':
        $ref: '#/components/responses/ValidationError'
      '401':
        $ref: '#/components/responses/Unauthorized'
      '403':
        $ref: '#/components/responses/Forbidden'
      '404':
        $ref: '#/components/responses/NotFound'
      '500':
        $ref: '#/components/responses/ServerError'

  delete:
    tags:
      - Inventory Items
    summary: Delete Inventory Item
    description: |
      Soft delete inventory item. Items with stock or pending movements cannot be deleted.
    operationId: deleteInventoryItem
    security:
      - bearerAuth: []
    x-permissions:
      - inventory.item.delete
    parameters:
      - $ref: '#/components/parameters/TenantHeader'
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: Inventory item ID
    responses:
      '200':
        $ref: '#/components/responses/DeletedResponse'
      '400':
        description: Cannot delete item with existing stock or movements
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ErrorResponse'
            examples:
              has_stock:
                summary: Deletion blocked - stock present
                value:
                  success: false
                  error:
                    code: "HAS_STOCK"
                    message: "Item cannot be deleted because stock exists"
      '401':
        $ref: '#/components/responses/Unauthorized'
      '403':
        $ref: '#/components/responses/Forbidden'
      '404':
        $ref: '#/components/responses/NotFound'
      '500':
        $ref: '#/components/responses/ServerError'

# Inventory Locations Management
/admin/inventory/locations:
  get:
    tags:
      - Inventory Locations
    summary: List Storage Locations
    description: |
      Retrieve all inventory storage locations with capacity information and hierarchy.
    operationId: listInventoryLocations
    security:
      - bearerAuth: []
    x-permissions:
      - inventory.location.list
    parameters:
      - $ref: '#/components/parameters/TenantHeader'
      - name: location_type
        in: query
        schema:
          type: string
          enum: [warehouse, production, quality_control, shipping, receiving, quarantine, scrap]
        description: Filter by location type
      - name: active_only
        in: query
        schema:
          type: boolean
          default: true
        description: Show only active locations
    responses:
      '200':
        description: Locations retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/BaseResponse'
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '#/components/schemas/InventoryLocation'
            examples:
              ok:
                summary: Locations list
                value:
                  success: true
                  data:
                    - id: "111e8400-e29b-41d4-a716-446655440111"
                      location_code: "WH-01-B-01"
                      location_name: "Main Warehouse - Section B - Bay 01"
                      location_type: "warehouse"
                      total_capacity: 500.0
                      is_active: true
                    - id: "222e8400-e29b-41d4-a716-446655440222"
                      location_code: "QC-01"
                      location_name: "Quality Control"
                      location_type: "quality_control"
                      total_capacity: 50.0
                      is_active: true
      '401':
        $ref: '#/components/responses/Unauthorized'
      '403':
        $ref: '#/components/responses/Forbidden'
      '429':
        $ref: '#/components/responses/RateLimitExceeded'
      '500':
        $ref: '#/components/responses/ServerError'

  post:
    tags:
      - Inventory Locations
    summary: Create Storage Location
    description: |
      Create new storage location with capacity and environmental specifications.
    operationId: createInventoryLocation
    security:
      - bearerAuth: []
    x-permissions:
      - inventory.location.create
    parameters:
      - $ref: '#/components/parameters/TenantHeader'
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/InventoryLocationCreateInput'
          examples:
            main_warehouse:
              summary: Create main warehouse location
              value:
                location_code: "WH-01-B-01"
                location_name: "Main Warehouse - Section B - Bay 01"
                description: "Secondary storage for finished goods"
                location_type: "warehouse"
                total_capacity: 500.0
                is_active: true
    responses:
      '201':
        $ref: '#/components/responses/CreatedResponse'
      '400':
        $ref: '#/components/responses/ValidationError'
      '401':
        $ref: '#/components/responses/Unauthorized'
      '403':
        $ref: '#/components/responses/Forbidden'
      '409':
        $ref: '#/components/responses/Conflict'
      '500':
        $ref: '#/components/responses/ServerError'

# Inventory Movements Management
/admin/inventory/movements:
  get:
    tags:
      - Inventory Movements
    summary: List Inventory Movements
    description: |
      Retrieve inventory movement history with filtering and audit trail.
      
      **Movement Types:**
      - Receipt: Incoming stock from suppliers
      - Issue: Outbound stock to customers/production
      - Transfer: Inter-location stock transfers
      - Adjustment: Stock level corrections
      - Production: Consumption and output from production
      - Return: Customer/supplier returns
      - Scrap: Waste and damaged goods
    operationId: listInventoryMovements
    security:
      - bearerAuth: []
    x-permissions:
      - inventory.movement.list
    parameters:
      - $ref: '#/components/parameters/TenantHeader'
      - $ref: '#/components/parameters/PageParam'
      - $ref: '#/components/parameters/PerPageParam'
      - name: item_id
        in: query
        schema:
          type: string
          format: uuid
        description: Filter by specific item
      - name: location_id
        in: query
        schema:
          type: string
          format: uuid
        description: Filter by location (from or to)
      - name: movement_type
        in: query
        schema:
          type: string
          enum: [receipt, issue, transfer, adjustment, production_consumption, production_output, return, scrap]
        description: Filter by movement type
      - name: date_from
        in: query
        schema:
          type: string
          format: date
        description: Filter from date
      - name: date_to
        in: query
        schema:
          type: string
          format: date
        description: Filter to date
      - name: status
        in: query
        schema:
          type: string
          enum: [pending, approved, rejected, cancelled]
        description: Filter by approval status
    responses:
      '200':
        description: Movements retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/PaginatedResponse'
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '#/components/schemas/InventoryMovement'
                    meta:
                      $ref: '#/components/schemas/PaginationMeta'
            examples:
              ok:
                summary: Movements list
                value:
                  success: true
                  data:
                    - id: "550e8400-e29b-41d4-a716-446655440000"
                      movement_type: "receipt"
                      quantity: 100.0
                      status: "approved"
                      created_at: "2025-02-14T10:30:00Z"
                    - id: "123e4567-e89b-12d3-a456-426614174000"
                      movement_type: "transfer"
                      quantity: 25.0
                      status: "pending"
                      created_at: "2025-02-15T12:00:00Z"
                  meta:
                    page: 1
                    per_page: 10
                    total: 2
      '401':
        $ref: '#/components/responses/Unauthorized'
      '403':
        $ref: '#/components/responses/Forbidden'
      '429':
        $ref: '#/components/responses/RateLimitExceeded'
      '500':
        $ref: '#/components/responses/ServerError'

  post:
    tags:
      - Inventory Movements
    summary: Create Inventory Movement
    description: |
      Create new inventory movement record. Automatically updates stock levels upon approval.
    operationId: createInventoryMovement
    security:
      - bearerAuth: []
    x-permissions:
      - inventory.movement.create
    parameters:
      - $ref: '#/components/parameters/TenantHeader'
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/InventoryMovementCreateInput'
          examples:
            stock_receipt:
              summary: Stock receipt from supplier
              value:
                movement_type: "receipt"
                item_id: "550e8400-e29b-41d4-a716-446655440000"
                to_location_id: "660f9500-f39c-52e5-b827-557766551111"
                quantity: 100.00
                unit_cost: 50000.00
                batch_number: "BATCH-2024-002"
                reference_type: "purchase_order"
                reference_number: "PO-2024-002"
                reason_code: "PURCHASE_RECEIPT"
                notes: "Received from supplier XYZ Corp"
    responses:
      '201':
        $ref: '#/components/responses/CreatedResponse'
      '400':
        $ref: '#/components/responses/ValidationError'
      '401':
        $ref: '#/components/responses/Unauthorized'
      '403':
        $ref: '#/components/responses/Forbidden'
      '500':
        $ref: '#/components/responses/ServerError'

/admin/inventory/movements/{id}/approve:
  post:
    tags:
      - Inventory Movements
    summary: Approve Inventory Movement
    description: |
      Approve pending inventory movement. This will update actual stock levels.
    operationId: approveInventoryMovement
    security:
      - bearerAuth: []
    x-permissions:
      - inventory.movement.approve
    parameters:
      - $ref: '#/components/parameters/TenantHeader'
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: Movement ID
    requestBody:
      content:
        application/json:
          schema:
            type: object
            properties:
              approval_notes:
                type: string
                description: Approval notes
                example: "Verified receipt and quality check passed"
    responses:
      '200':
        description: Movement approved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/BaseResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/InventoryMovement'
            examples:
              ok:
                summary: Movement approved
                value:
                  success: true
                  data:
                    id: "550e8400-e29b-41d4-a716-446655440000"
                    movement_type: "receipt"
                    status: "approved"
                    approved_at: "2025-02-16T13:00:00Z"
      '400':
        description: Movement cannot be approved (invalid status)
      '401':
        $ref: '#/components/responses/Unauthorized'
      '403':
        $ref: '#/components/responses/Forbidden'
      '404':
        $ref: '#/components/responses/NotFound'
      '500':
        $ref: '#/components/responses/ServerError'

# Inventory Adjustments Management
/admin/inventory/adjustments:
  get:
    tags:
      - Inventory Adjustments
    summary: List Inventory Adjustments
    description: |
      Retrieve inventory adjustments and cycle count records.
    operationId: listInventoryAdjustments
    security:
      - bearerAuth: []
    x-permissions:
      - inventory.adjustment.list
    parameters:
      - $ref: '#/components/parameters/TenantHeader'
      - $ref: '#/components/parameters/PageParam'
      - $ref: '#/components/parameters/PerPageParam'
      - name: adjustment_type
        in: query
        schema:
          type: string
          enum: [cycle_count, physical_count, shrinkage, damage, obsolete, correction, write_off]
        description: Filter by adjustment type
      - name: status
        in: query
        schema:
          type: string
          enum: [pending, approved, rejected, cancelled]
        description: Filter by approval status
    responses:
      '200':
        description: Adjustments retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/PaginatedResponse'
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '#/components/schemas/InventoryAdjustment'
                    meta:
                      $ref: '#/components/schemas/PaginationMeta'
            examples:
              ok:
                summary: Adjustments list
                value:
                  success: true
                  data:
                    - id: "550e8400-e29b-41d4-a716-446655440000"
                      adjustment_type: "cycle_count"
                      status: "approved"
                      created_at: "2025-02-12T09:00:00Z"
                    - id: "123e4567-e89b-12d3-a456-426614174000"
                      adjustment_type: "damage"
                      status: "pending"
                      created_at: "2025-02-14T10:00:00Z"
                  meta:
                    page: 1
                    per_page: 10
                    total: 2
      '401':
        $ref: '#/components/responses/Unauthorized'
      '403':
        $ref: '#/components/responses/Forbidden'
      '429':
        $ref: '#/components/responses/RateLimitExceeded'
      '500':
        $ref: '#/components/responses/ServerError'

# Inventory Alerts Management
/admin/inventory/alerts:
  get:
    tags:
      - Inventory Alerts
    summary: List Inventory Alerts
    description: |
      Retrieve active inventory alerts including low stock, expiry warnings, and quality issues.
    operationId: listInventoryAlerts
    security:
      - bearerAuth: []
    x-permissions:
      - inventory.alert.list
    parameters:
      - $ref: '#/components/parameters/TenantHeader'
      - name: alert_type
        in: query
        schema:
          type: string
          enum: [low_stock, out_of_stock, overstock, expiry_warning, expired, slow_moving, dead_stock, quality_issue]
        description: Filter by alert type
      - name: priority
        in: query
        schema:
          type: string
          enum: [low, medium, high, critical]
        description: Filter by priority level
      - name: status
        in: query
        schema:
          type: string
          enum: [active, acknowledged, resolved, dismissed]
        description: Filter by alert status
    responses:
      '200':
        description: Alerts retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/BaseResponse'
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '#/components/schemas/InventoryAlert'
            examples:
              ok:
                summary: Alerts list
                value:
                  success: true
                  data:
                    - id: "660f9500-f39c-52e5-b827-557766551111"
                      alert_type: "low_stock"
                      priority: "high"
                      title: "Low Stock Alert: Brass Sheet 2mm"
                      current_stock: 15.5
                      threshold_value: 20.0
                    - id: "770fa610-a39d-62f6-c938-668877662222"
                      alert_type: "expiry_warning"
                      priority: "medium"
                      title: "Expiry Warning: Chemical A"
                      expires_in_days: 12
      '401':
        $ref: '#/components/responses/Unauthorized'
      '403':
        $ref: '#/components/responses/Forbidden'
      '429':
        $ref: '#/components/responses/RateLimitExceeded'
      '500':
        $ref: '#/components/responses/ServerError'

/admin/inventory/alerts/{id}/acknowledge:
  post:
    tags:
      - Inventory Alerts
    summary: Acknowledge Alert
    description: |
      Acknowledge inventory alert to mark it as seen and being handled.
    operationId: acknowledgeInventoryAlert
    security:
      - bearerAuth: []
    x-permissions:
      - inventory.alert.acknowledge
    parameters:
      - $ref: '#/components/parameters/TenantHeader'
      - name: id
        in: path
        required: true
        schema:
          type: string
          format: uuid
        description: Alert ID
    responses:
      '200':
        $ref: '#/components/responses/SuccessResponse'
      '401':
        $ref: '#/components/responses/Unauthorized'
      '403':
        $ref: '#/components/responses/Forbidden'
      '404':
        $ref: '#/components/responses/NotFound'
      '500':
        $ref: '#/components/responses/ServerError'

# Inventory Count Sessions
/admin/inventory/counts:
  get:
    tags:
      - Inventory Counts
    summary: List Count Sessions
    description: |
      Retrieve inventory count sessions including scheduled and completed counts.
    operationId: listInventoryCounts
    security:
      - bearerAuth: []
    x-permissions:
      - inventory.count.list
    parameters:
      - $ref: '#/components/parameters/TenantHeader'
      - name: status
        in: query
        schema:
          type: string
          enum: [planned, in_progress, completed, cancelled, on_hold]
        description: Filter by count status
      - name: count_type
        in: query
        schema:
          type: string
          enum: [full_physical, cycle_count, spot_check, abc_analysis, annual_count]
        description: Filter by count type
    responses:
      '200':
        description: Count sessions retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/BaseResponse'
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '#/components/schemas/InventoryCount'
            examples:
              ok:
                summary: Counts list
                value:
                  success: true
                  data:
                    - id: "550e8400-e29b-41d4-a716-446655440000"
                      count_type: "cycle_count"
                      status: "planned"
                    - id: "123e4567-e89b-12d3-a456-426614174000"
                      count_type: "full_physical"
                      status: "completed"
      '401':
        $ref: '#/components/responses/Unauthorized'
      '403':
        $ref: '#/components/responses/Forbidden'
      '429':
        $ref: '#/components/responses/RateLimitExceeded'
      '500':
        $ref: '#/components/responses/ServerError'

# Inventory Reservations Management
/admin/inventory/reservations:
  get:
    tags:
      - Inventory Reservations
    summary: List Stock Reservations
    description: |
      Retrieve inventory reservations for orders and production.
    operationId: listInventoryReservations
    security:
      - bearerAuth: []
    x-permissions:
      - inventory.reservation.list
    parameters:
      - $ref: '#/components/parameters/TenantHeader'
      - name: reservation_type
        in: query
        schema:
          type: string
          enum: [sales_order, production_order, transfer_order, quality_hold, manual_hold]
        description: Filter by reservation type
      - name: status
        in: query
        schema:
          type: string
          enum: [active, partial, fulfilled, cancelled, expired]
        description: Filter by reservation status
    responses:
      '200':
        description: Reservations retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/BaseResponse'
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '#/components/schemas/InventoryReservation'
            examples:
              ok:
                summary: Reservations list
                value:
                  success: true
                  data:
                    - id: "550e8400-e29b-41d4-a716-446655440000"
                      reservation_type: "sales_order"
                      status: "active"
                      reference_number: "SO-2025-001"
                    - id: "123e4567-e89b-12d3-a456-426614174000"
                      reservation_type: "production_order"
                      status: "fulfilled"
                      reference_number: "MO-2025-010"
      '401':
        $ref: '#/components/responses/Unauthorized'
      '403':
        $ref: '#/components/responses/Forbidden'
      '429':
        $ref: '#/components/responses/RateLimitExceeded'
      '500':
        $ref: '#/components/responses/ServerError'

/admin/inventory/reconciliation:
  get:
    tags:
      - Inventory Reconciliation
    summary: List Reconciliation Batches
    description: |
      Retrieve reconciliation batches, variances, and audit summaries across multi-tenant locations.
    operationId: listInventoryReconciliations
    security:
      - bearerAuth: []
    x-permissions:
      - inventory.reconciliation.list
    parameters:
      - $ref: '#/components/parameters/TenantHeader'
      - name: status
        in: query
        schema:
          type: string
          enum: [pending, processing, completed, needs_review]
      - name: location_id
        in: query
        schema:
          type: string
          format: uuid
      - name: created_from
        in: query
        schema:
          type: string
          format: date
      - name: created_to
        in: query
        schema:
          type: string
          format: date
    responses:
      '200':
        description: Reconciliation batches retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/BaseResponse'
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          started_at:
                            type: string
                            format: date-time
                          completed_at:
                            type: string
                            format: date-time
                            nullable: true
                          status:
                            type: string
                          location_scope:
                            type: array
                            items:
                              type: string
                              format: uuid
                          variance_count:
                            type: integer
                          variance_value:
                            type: number
                            format: double
                          created_by:
                            type: string
                    meta:
                      $ref: '#/components/schemas/PaginationMeta'
            examples:
              ok:
                summary: Reconciliation list
                value:
                  success: true
                  data:
                    - id: "8f26c0b1-496f-4f33-953b-5ef5589c7d92"
                      started_at: '2025-11-15T01:30:00Z'
                      completed_at: '2025-11-15T04:45:00Z'
                      status: completed
                      location_scope:
                        - "b6d5ff46-9d8a-448b-9079-7f98d6d3a111"
                      variance_count: 12
                      variance_value: -1850000.00
                      created_by: 'inventory_controller'
                  meta:
                    page: 1
                    per_page: 20
                    total: 3
      '401':
        $ref: '#/components/responses/Unauthorized'
      '403':
        $ref: '#/components/responses/Forbidden'
      '500':
        $ref: '#/components/responses/ServerError'

  post:
    tags:
      - Inventory Reconciliation
    summary: Start Reconciliation Job
    description: |
      Launch reconciliation workflow comparing system balances with counted quantities, including tolerance and escalation rules.
    operationId: startInventoryReconciliation
    security:
      - bearerAuth: []
    x-permissions:
      - inventory.reconciliation.create
    parameters:
      - $ref: '#/components/parameters/TenantHeader'
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required:
              - counted_at
              - locations
            properties:
              counted_at:
                type: string
                format: date-time
              locations:
                type: array
                minItems: 1
                items:
                  type: object
                  required:
                    - location_id
                  properties:
                    location_id:
                      type: string
                      format: uuid
                    counted_by:
                      type: string
                    notes:
                      type: string
                      nullable: true
              include_categories:
                type: array
                items:
                  type: string
              exclude_item_types:
                type: array
                items:
                  type: string
              auto_create_adjustments:
                type: boolean
                default: false
              tolerance_ruleset_id:
                type: string
                format: uuid
                nullable: true
              notify_roles:
                type: array
                items:
                  type: string
          examples:
            reconciliation_request:
              summary: Full warehouse reconciliation
              value:
                counted_at: '2025-11-17T23:00:00Z'
                locations:
                  - location_id: "b6d5ff46-9d8a-448b-9079-7f98d6d3a111"
                    counted_by: 'night_shift_team'
                include_categories:
                  - Raw Materials
                  - Finished Goods
                auto_create_adjustments: false
                tolerance_ruleset_id: "173c49e1-904a-44f1-9f55-0a61edba2b80"
                notify_roles:
                  - operations_manager
                  - finance_controller
    responses:
      '202':
        description: Reconciliation job accepted
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/BaseResponse'
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        reconciliation_id:
                          type: string
                          format: uuid
                        status:
                          type: string
                        expected_completion_at:
                          type: string
                          format: date-time
            examples:
              ok:
                summary: Job accepted
                value:
                  success: true
                  data:
                    reconciliation_id: "8f26c0b1-496f-4f33-953b-5ef5589c7d92"
                    status: pending
                    expected_completion_at: '2025-11-18T02:00:00Z'
                  message: Reconciliation started
                  meta:
                    timestamp: '2025-11-17T23:05:00Z'
      '400':
        $ref: '#/components/responses/ValidationError'
      '401':
        $ref: '#/components/responses/Unauthorized'
      '403':
        $ref: '#/components/responses/Forbidden'
      '409':
        $ref: '#/components/responses/Conflict'
      '500':
        $ref: '#/components/responses/ServerError'

/admin/inventory/analytics:
  get:
    tags:
      - Inventory Analytics
    summary: Inventory Analytics Dashboard
    description: |
      Provide multi-tenant inventory analytics including aging, turnover, valuation, and SLA compliance metrics.
    operationId: getInventoryAnalytics
    security:
      - bearerAuth: []
    x-permissions:
      - inventory.analytics.read
    parameters:
      - $ref: '#/components/parameters/TenantHeader'
      - name: range
        in: query
        schema:
          type: string
          enum: [daily, weekly, monthly, quarterly]
        description: Reporting interval
      - name: location_id
        in: query
        schema:
          type: string
          format: uuid
        description: Filter analytics by location
      - name: category
        in: query
        schema:
          type: string
        description: Filter analytics by category
    responses:
      '200':
        description: Analytics data retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/BaseResponse'
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        stock_valuation:
                          type: object
                          properties:
                            total_value:
                              type: number
                              format: double
                            currency:
                              type: string
                            breakdown:
                              type: array
                              items:
                                type: object
                                properties:
                                  category:
                                    type: string
                                  value:
                                    type: number
                                    format: double
                        turnover_ratio:
                          type: number
                          format: double
                        aging_buckets:
                          type: array
                          items:
                            type: object
                            properties:
                              bucket:
                                type: string
                              quantity:
                                type: number
                                format: double
                        reservation_utilization:
                          type: object
                          properties:
                            total_reserved:
                              type: number
                              format: double
                            fulfillment_rate:
                              type: number
                              format: double
                        sla_compliance:
                          type: object
                          properties:
                            movement_sla:
                              type: number
                              format: double
                            count_completion_sla:
                              type: number
                              format: double
                        alerts_summary:
                          type: object
                          properties:
                            low_stock:
                              type: integer
                            quality_hold:
                              type: integer
                            expiring:
                              type: integer
            examples:
              ok:
                summary: Analytics snapshot
                value:
                  success: true
                  data:
                    stock_valuation:
                      total_value: 125750000.00
                      currency: IDR
                      breakdown:
                        - category: Raw Materials
                          value: 80500000.00
                        - category: Finished Goods
                          value: 45250000.00
                    turnover_ratio: 5.4
                    aging_buckets:
                      - bucket: 0-30 days
                        quantity: 340
                      - bucket: 31-60 days
                        quantity: 145
                      - bucket: 61-90 days
                        quantity: 62
                      - bucket: 90+ days
                        quantity: 18
                    reservation_utilization:
                      total_reserved: 128
                      fulfillment_rate: 92.5
                    sla_compliance:
                      movement_sla: 96.4
                      count_completion_sla: 88.1
                    alerts_summary:
                      low_stock: 12
                      quality_hold: 4
                      expiring: 3
                  meta:
                    timestamp: '2025-11-18T09:42:00Z'

# Inventory Suppliers Management
/admin/inventory/suppliers:
  get:
    tags:
      - Inventory Suppliers
    summary: List Item Suppliers
    description: |
      Retrieve supplier relationships for inventory items including pricing and lead times.
    operationId: listInventorySuppliers
    security:
      - bearerAuth: []
    x-permissions:
      - inventory.supplier.list
    parameters:
      - $ref: '#/components/parameters/TenantHeader'
      - name: item_id
        in: query
        schema:
          type: string
          format: uuid
        description: Filter by specific item
      - name: supplier_id
        in: query
        schema:
          type: string
          format: uuid
        description: Filter by specific supplier
      - name: active_only
        in: query
        schema:
          type: boolean
          default: true
        description: Show only active supplier relationships
    responses:
      '200':
        description: Suppliers retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/BaseResponse'
                - type: object
                  properties:
                    data:
                      type: array
                      items:
                        $ref: '#/components/schemas/InventorySupplier'
            examples:
              ok:
                summary: Item suppliers list
                value:
                  success: true
                  data:
                    - supplier_id: "987e8400-e29b-41d4-a716-446655449999"
                      item_id: "550e8400-e29b-41d4-a716-446655440000"
                      lead_time_days: 7
                      is_preferred: true
                    - supplier_id: "abcde400-e29b-41d4-a716-44665544aaaa"
                      item_id: "550e8400-e29b-41d4-a716-446655440000"
                      lead_time_days: 10
                      is_preferred: false
      '401':
        $ref: '#/components/responses/Unauthorized'
      '403':
        $ref: '#/components/responses/Forbidden'
      '429':
        $ref: '#/components/responses/RateLimitExceeded'
      '500':
        $ref: '#/components/responses/ServerError'

# Bulk Operations
/admin/inventory/bulk/stock-update:
  post:
    tags:
      - Inventory Bulk Operations
    summary: Bulk Stock Update
    description: |
      Update stock levels for multiple items simultaneously.
      Useful for physical count results or mass adjustments.
    operationId: bulkStockUpdate
    security:
      - bearerAuth: []
    x-permissions:
      - inventory.bulk.stock_update
    parameters:
      - $ref: '#/components/parameters/TenantHeader'
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/BulkStockUpdateInput'
          examples:
            physical_count_update:
              summary: Bulk update from physical count
              value:
                updates:
                  - item_id: "550e8400-e29b-41d4-a716-446655440000"
                    location_id: "660f9500-f39c-52e5-b827-557766551111"
                    new_quantity: 95.50
                    reason: "Physical count adjustment - January 2024"
                  - item_id: "770fa610-a39d-62f6-c938-668877662222"
                    location_id: "660f9500-f39c-52e5-b827-557766551111"
                    new_quantity: 48.25
                    reason: "Physical count adjustment - January 2024"
    responses:
      '200':
        description: Bulk update completed successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/BaseResponse'
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        updated_count:
                          type: integer
                          example: 2
                        failed_updates:
                          type: array
                          items:
                            type: object
                            properties:
                              item_id:
                                type: string
                                format: uuid
                              error:
                                type: string
            examples:
              ok:
                summary: Bulk update result
                value:
                  success: true
                  data:
                    updated_count: 2
                    failed_updates:
                      - item_id: "770fa610-a39d-62f6-c938-668877662222"
                        error: "NOT_FOUND"
      '400':
        $ref: '#/components/responses/ValidationError'
      '401':
        $ref: '#/components/responses/Unauthorized'
      '403':
        $ref: '#/components/responses/Forbidden'
      '500':
        $ref: '#/components/responses/ServerError'

# Reports & Analytics
/admin/inventory/reports/low-stock:
  get:
    tags:
      - Inventory Reports
    summary: Low Stock Report
    description: |
      Generate comprehensive low stock report with recommended actions.
    operationId: getLowStockReport
    security:
      - bearerAuth: []
    x-permissions:
      - inventory.report.lowstock
    parameters:
      - $ref: '#/components/parameters/TenantHeader'
      - name: category
        in: query
        schema:
          type: string
        description: Filter by item category
      - name: location_id
        in: query
        schema:
          type: string
          format: uuid
        description: Filter by location
      - name: format
        in: query
        schema:
          type: string
          enum: [json, csv, excel]
          default: json
        description: Report format
    responses:
      '200':
        description: Low stock report generated successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/BaseResponse'
                - type: object
                  properties:
                    data:
                      $ref: '#/components/schemas/LowStockReport'
            examples:
              ok:
                summary: Low stock report
                value:
                  success: true
                  data:
                    items:
                      - item_id: "550e8400-e29b-41d4-a716-446655440000"
                        item_name: "Brass Sheet 3mm Thickness"
                        current_stock: 15.5
                        reorder_point: 25.0
                        recommended_action: "Increase PO by 10kg"
      '401':
        $ref: '#/components/responses/Unauthorized'
      '403':
        $ref: '#/components/responses/Forbidden'
      '429':
        $ref: '#/components/responses/RateLimitExceeded'
      '500':
        $ref: '#/components/responses/ServerError'

/admin/inventory/reports/valuation:
  get:
    tags:
      - Inventory Reports
    summary: Inventory Valuation Report
    description: |
      Generate inventory valuation report with cost analysis by different methods.
    operationId: getInventoryValuationReport
    security:
      - bearerAuth: []
    x-permissions:
      - inventory.report.valuation
    parameters:
      - $ref: '#/components/parameters/TenantHeader'
      - name: as_of_date
        in: query
        schema:
          type: string
          format: date
        description: Valuation date (defaults to current date)
      - name: valuation_method
        in: query
        schema:
          type: string
          enum: [FIFO, LIFO, AVERAGE, STANDARD]
        description: Override item valuation methods
      - name: location_id
        in: query
        schema:
          type: string
          format: uuid
        description: Filter by location
    responses:
      '200':
        description: Valuation report generated successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/BaseResponse'
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        report_date:
                          type: string
                          format: date-time
                        total_items:
                          type: integer
                        total_quantity:
                          type: number
                          format: decimal
                        total_value:
                          type: number
                          format: decimal
                        valuation_breakdown:
                          type: array
                          items:
                            type: object
                            properties:
                              item:
                                $ref: '#/components/schemas/InventoryItem'
                              quantity:
                                type: number
                                format: decimal
                              unit_cost:
                                type: number
                                format: decimal
                              total_value:
                                type: number
                                format: decimal
            examples:
              ok:
                summary: Valuation report
                value:
                  success: true
                  data:
                    report_date: "2025-02-15T23:59:59Z"
                    total_items: 2
                    total_quantity: 130.75
                    total_value: 7500000.5
                    valuation_breakdown:
                      - item:
                          id: "550e8400-e29b-41d4-a716-446655440000"
                          item_code: "MTL-BRASS-002"
                          item_name: "Brass Sheet 3mm Thickness"
                        quantity: 100.5
                        unit_cost: 55000.0
                        total_value: 5527500.0
                      - item:
                          id: "123e4567-e89b-12d3-a456-426614174000"
                          item_code: "TOOL-ETCH-001"
                          item_name: "Etching Tool Basic"
                        quantity: 30.25
                        unit_cost: 65000.0
                        total_value: 1966250.0
      '401':
        $ref: '#/components/responses/Unauthorized'
      '403':
        $ref: '#/components/responses/Forbidden'
      '429':
        $ref: '#/components/responses/RateLimitExceeded'
      '500':
        $ref: '#/components/responses/ServerError'
