# SEO MODULE SCHEMAS FOR STENCIL CMS
# Enterprise-Grade Universal SEO Management Engine - Complete Implementation
# 
# ARCHITECTURE: Multi-Tenant with Full Enterprise Features
# COVERAGE: 150+ fields, 8 tables, 35+ API endpoints
# COMPLIANCE: Hexagonal Architecture, Multi-Tenant Row-Level Security, AI-Powered Optimization
# VERSION: 2.0 Enterprise Edition - 100% Database Schema Aligned

# ==========================================
# CORE ENTITIES - Main SEO Tables (1-4 of 8)
# ==========================================

# SEO Default Settings - Enhanced Enterprise Version (Table 1 of 8)
DefaultSEOSettings:
  allOf:
    - $ref: '../common/base.yaml#/BaseEntity'
    - $ref: '../common/base.yaml#/AuditableEntity'
    - $ref: '../common/base.yaml#/AuditEntity'
    - type: object
      required:
        - site_name
        - default_meta_title
        - default_meta_description
      properties:
        # Basic Site Information
        site_name:
          type: string
          maxLength: 255
          description: "Main site/brand name for tenant"
          example: "Acme Etching Services"
        site_tagline:
          type: string
          maxLength: 500
          nullable: true
          description: "Site tagline or slogan"
          example: "Precision Craftsmanship, Every Time"
        site_description:
          type: string
          nullable: true
          description: "Site description for search engines"
          example: "Professional etching services with state-of-the-art technology"

        # Default Meta Templates (Tenant-Scoped)
        default_meta_title:
          type: string
          maxLength: 255
          description: "Default meta title template (supports variables)"
          example: "{page} | {site_name}"
        default_meta_description:
          type: string
          nullable: true
          description: "Default meta description fallback"
          example: "Discover our premium services and solutions"
        default_meta_keywords:
          type: string
          nullable: true
          description: "Default meta keywords (comma-separated)"
          example: "etching, laser engraving, custom fabrication"

        # Open Graph Defaults (Enhanced)
        og_type:
          type: string
          maxLength: 50
          default: "website"
          description: "Default Open Graph type"
          example: "website"
        og_site_name:
          type: string
          maxLength: 255
          nullable: true
          description: "Open Graph site name"
          example: "Acme Etching Services"
        og_default_image_url:
          type: string
          format: uri
          maxLength: 500
          nullable: true
          description: "Default OG image URL"
          example: "https://cdn.acme.com/og-default.jpg"
        og_locale:
          type: string
          maxLength: 10
          default: "id_ID"
          description: "Default Open Graph locale"
          example: "id_ID"

        # Twitter Card Defaults (Enhanced)
        twitter_card_type:
          type: string
          maxLength: 50
          default: "summary_large_image"
          description: "Default Twitter Card type"
          example: "summary_large_image"
        twitter_site:
          type: string
          maxLength: 100
          nullable: true
          description: "Twitter site handle (@username)"
          example: "@acme_etching"
        twitter_creator:
          type: string
          maxLength: 100
          nullable: true
          description: "Default Twitter creator handle"
          example: "@acme_etching"

        # Schema.org Defaults (Advanced)
        schema_org_type:
          type: string
          maxLength: 50
          default: "Organization"
          description: "Default Schema.org type"
          example: "Organization"
        schema_org_data:
          type: object
          nullable: true
          description: "Default Schema.org structured data"
          additionalProperties: true
          example:
            "@type": "Organization"
            "name": "Acme Etching Services"
            "description": "Professional etching and engraving services"
            "url": "https://acme-etching.com"
            "contactPoint":
              "@type": "ContactPoint"
              "telephone": "+62-21-1234567"
              "contactType": "customer service"

        # SEO Behavior Settings
        default_robots:
          type: string
          maxLength: 100
          default: "index, follow"
          description: "Default robots meta directive"
          example: "index, follow"
        allow_search_engines:
          type: boolean
          default: true
          description: "Allow search engine indexing"
        canonical_base_url:
          type: string
          format: uri
          maxLength: 500
          nullable: true
          description: "Base URL for canonical links"
          example: "https://acme-etching.com"

        # Search Engine Verification (Multi-Engine)
        google_site_verification:
          type: string
          maxLength: 255
          nullable: true
          description: "Google Search Console verification code"
          example: "abc123def456ghi789"
        bing_site_verification:
          type: string
          maxLength: 255
          nullable: true
          description: "Bing Webmaster Tools verification"
          example: "xyz789abc123def456"
        yandex_verification:
          type: string
          maxLength: 255
          nullable: true
          description: "Yandex verification code"
          example: "yandex123456"
        baidu_verification:
          type: string
          maxLength: 255
          nullable: true
          description: "Baidu verification code"
          example: "baidu123456"

        # Social Media Profiles (Enterprise Integration)
        facebook_page_url:
          type: string
          format: uri
          maxLength: 500
          nullable: true
          description: "Facebook page URL"
          example: "https://facebook.com/acme-etching"
        instagram_url:
          type: string
          format: uri
          maxLength: 500
          nullable: true
          description: "Instagram profile URL"
          example: "https://instagram.com/acme_etching"
        twitter_url:
          type: string
          format: uri
          maxLength: 500
          nullable: true
          description: "Twitter profile URL"
          example: "https://twitter.com/acme_etching"
        linkedin_url:
          type: string
          format: uri
          maxLength: 500
          nullable: true
          description: "LinkedIn company page URL"
          example: "https://linkedin.com/company/acme-etching"
        youtube_url:
          type: string
          format: uri
          maxLength: 500
          nullable: true
          description: "YouTube channel URL"
          example: "https://youtube.com/c/acme-etching"
        tiktok_url:
          type: string
          format: uri
          maxLength: 500
          nullable: true
          description: "TikTok profile URL"
          example: "https://tiktok.com/@acme_etching"

        # Advanced SEO Features (Enterprise)
        enable_auto_meta_generation:
          type: boolean
          default: true
          description: "Auto-generate meta tags from content"
        enable_ai_optimization:
          type: boolean
          default: false
          description: "Enable AI-powered SEO optimization"
        enable_structured_data:
          type: boolean
          default: true
          description: "Generate Schema.org structured data"
        enable_breadcrumbs:
          type: boolean
          default: true
          description: "Generate breadcrumb structured data"

        # Performance & Caching
        enable_meta_caching:
          type: boolean
          default: true
          description: "Cache generated meta tags"
        cache_duration_minutes:
          type: integer
          default: 60
          minimum: 1
          maximum: 1440
          description: "Meta tag cache duration"

        # Analytics Integration
        google_analytics_id:
          type: string
          maxLength: 50
          nullable: true
          description: "Google Analytics tracking ID"
          example: "GA_MEASUREMENT_ID"
        google_tag_manager_id:
          type: string
          maxLength: 50
          nullable: true
          description: "Google Tag Manager container ID"
          example: "GTM-XXXXXXX"
        facebook_pixel_id:
          type: string
          maxLength: 50
          nullable: true
          description: "Facebook Pixel ID"
          example: "123456789012345"

# Enhanced SEO Meta - Polymorphic with AI Features (Table 2 of 8)
SEOMeta:
  allOf:
    - $ref: '../common/base.yaml#/BaseEntity'
    - $ref: '../common/base.yaml#/AuditableEntity'
    - $ref: '../common/base.yaml#/AuditEntity'
    - type: object
      required:
        - seo_metable_type
        - seo_metable_id
      properties:
        # Polymorphic Relationship (Tenant-Scoped)
        seo_metable_type:
          type: string
          maxLength: 255
          description: "Model type (products, pages, categories, etc.)"
          example: "App\\Models\\Product"
        seo_metable_id:
          type: string
          format: uuid
          description: "Referenced entity UUID"
          example: "550e8400-e29b-41d4-a716-446655440000"

        # Basic Meta Tags (Enhanced)
        meta_title:
          type: string
          maxLength: 255
          nullable: true
          description: "Custom meta title (60 chars recommended)"
          example: "Premium Laser Etching Services - Acme Corp"
        meta_description:
          type: string
          nullable: true
          description: "Custom meta description (160 chars recommended)"
          example: "Professional laser etching services with precision craftsmanship. Custom metal, glass, and acrylic engraving solutions."
        meta_keywords:
          type: string
          nullable: true
          description: "Meta keywords (comma-separated)"
          example: "laser etching, metal engraving, custom fabrication"

        # Open Graph (Complete Implementation)
        og_title:
          type: string
          maxLength: 255
          nullable: true
          description: "Open Graph title"
          example: "Premium Laser Etching Services"
        og_description:
          type: string
          nullable: true
          description: "Open Graph description"
          example: "Transform your ideas into reality with our precision etching technology"
        og_image_url:
          type: string
          format: uri
          maxLength: 500
          nullable: true
          description: "Open Graph image URL"
          example: "https://cdn.acme.com/products/laser-etching-og.jpg"
        og_type:
          type: string
          maxLength: 50
          nullable: true
          description: "Open Graph content type"
          example: "article"
        og_locale:
          type: string
          maxLength: 10
          nullable: true
          description: "Open Graph locale"
          example: "id_ID"

        # Twitter Card (Complete Implementation)
        twitter_title:
          type: string
          maxLength: 255
          nullable: true
          description: "Twitter Card title"
          example: "Premium Laser Etching Services"
        twitter_description:
          type: string
          nullable: true
          description: "Twitter Card description"
          example: "Professional precision etching for all materials"
        twitter_image_url:
          type: string
          format: uri
          maxLength: 500
          nullable: true
          description: "Twitter Card image URL"
          example: "https://cdn.acme.com/products/twitter-card.jpg"
        twitter_card_type:
          type: string
          maxLength: 50
          nullable: true
          description: "Twitter Card type"
          example: "summary_large_image"

        # Advanced SEO Fields
        canonical_url:
          type: string
          format: uri
          maxLength: 500
          nullable: true
          description: "Canonical URL for this content"
          example: "https://acme-etching.com/services/laser-etching"
        robots:
          type: string
          maxLength: 100
          nullable: true
          description: "Robots meta directive"
          example: "index, follow"

        # Schema.org Structured Data (Advanced)
        schema_type:
          type: string
          maxLength: 50
          nullable: true
          description: "Primary Schema.org type"
          example: "Product"
        schema_data:
          type: object
          nullable: true
          description: "Complete Schema.org structured data"
          additionalProperties: true
          example:
            "@type": "Product"
            "name": "Laser Etching Service"
            "description": "Professional laser etching for metals and acrylics"
            "offers":
              "@type": "Offer"
              "availability": "InStock"
              "price": "50.00"
              "priceCurrency": "USD"

        # Custom Meta Tags (Flexible)
        custom_meta_tags:
          type: object
          nullable: true
          description: "Custom HTML meta tags (key-value pairs)"
          additionalProperties: true
          example:
            "theme-color": "#1a365d"
            "apple-mobile-web-app-capable": "yes"

        # SEO Scoring & Analysis (Enterprise Feature)
        seo_score:
          type: integer
          minimum: 0
          maximum: 100
          default: 0
          description: "SEO quality score (0-100)"
          example: 85
        seo_issues:
          type: array
          items:
            type: object
            properties:
              category:
                type: string
                example: "title_length"
              severity:
                type: string
                enum: [low, medium, high, critical]
                example: "medium"
              message:
                type: string
                example: "Meta title is too long (75 characters, recommended: 50-60)"
              suggestion:
                type: string
                example: "Shorten title to improve click-through rates"
          description: "Identified SEO issues"
        last_analyzed_at:
          type: string
          format: date-time
          nullable: true
          description: "Last SEO analysis timestamp"
          example: "2025-11-12T10:00:00Z"

        # AI-Powered Features (Advanced)
        ai_generated_title:
          type: string
          maxLength: 255
          nullable: true
          description: "AI-generated meta title suggestion"
          example: "Professional Laser Etching | Custom Metal & Acrylic Engraving"
        ai_generated_description:
          type: string
          nullable: true
          description: "AI-generated meta description"
          example: "Expert laser etching services for metals, glass & acrylics. Precision craftsmanship with fast turnaround. Get your free quote today!"
        ai_suggestions:
          type: array
          items:
            type: object
            properties:
              type:
                type: string
                enum: [title, description, keywords, schema]
                example: "title"
              suggestion:
                type: string
                example: "Consider adding location-based keywords for local SEO"
              confidence:
                type: number
                format: decimal
                minimum: 0
                maximum: 1
                example: 0.85
              impact:
                type: string
                enum: [low, medium, high]
                example: "high"
          description: "AI optimization suggestions"
        ai_last_updated_at:
          type: string
          format: date-time
          nullable: true
          description: "Last AI analysis timestamp"
          example: "2025-11-12T10:00:00Z"

        # Performance Tracking (Search Console Integration)
        click_through_rate:
          type: number
          format: decimal
          multipleOf: 0.0001
          minimum: 0
          maximum: 1
          default: 0
          description: "CTR from search results (0-1)"
          example: 0.0875
        impressions:
          type: integer
          minimum: 0
          default: 0
          description: "Search impressions count"
          example: 1250
        clicks:
          type: integer
          minimum: 0
          default: 0
          description: "Search clicks count"
          example: 109
        average_position:
          type: number
          format: decimal
          multipleOf: 0.01
          minimum: 0
          default: 0
          description: "Average search result position"
          example: 5.7

        # Status & Control
        is_enabled:
          type: boolean
          default: true
          description: "Whether SEO meta is active"
        is_ai_optimized:
          type: boolean
          default: false
          description: "Whether AI optimization was applied"
        optimization_status:
          type: string
          enum: [pending, optimized, needs_review, manual]
          default: "pending"
          description: "Optimization status"
          example: "optimized"

# SEO Analytics - Performance Tracking (Table 3 of 8)
SEOAnalytics:
  allOf:
    - $ref: '../common/base.yaml#/BaseEntity'
    - $ref: '../common/base.yaml#/AuditableEntity'
    - type: object
      required:
        - url
        - date_recorded
      properties:
        # Reference & URL Info
        seo_meta_id:
          type: string
          format: uuid
          nullable: true
          description: "Associated SEO meta record"
          example: "550e8400-e29b-41d4-a716-446655440000"
        url:
          type: string
          maxLength: 1000
          description: "URL being tracked"
          example: "https://acme-etching.com/services/laser-etching"
        page_title:
          type: string
          maxLength: 255
          nullable: true
          description: "Page title at time of recording"
          example: "Laser Etching Services"
        page_type:
          type: string
          maxLength: 100
          nullable: true
          description: "Type of page/content"
          example: "service_page"

        # Search Console Data (Primary Metrics)
        impressions:
          type: integer
          minimum: 0
          default: 0
          description: "Search impressions for this URL"
          example: 850
        clicks:
          type: integer
          minimum: 0
          default: 0
          description: "Search clicks for this URL"
          example: 74
        click_through_rate:
          type: number
          format: decimal
          multipleOf: 0.0001
          minimum: 0
          maximum: 1
          default: 0
          description: "Click-through rate (0-1)"
          example: 0.0871
        average_position:
          type: number
          format: decimal
          multipleOf: 0.01
          minimum: 0
          default: 0
          description: "Average search position"
          example: 4.2

        # Keywords Performance (Enhanced)
        primary_keyword:
          type: string
          maxLength: 255
          nullable: true
          description: "Primary target keyword"
          example: "laser etching services"
        keyword_ranking:
          type: integer
          nullable: true
          minimum: 1
          description: "Current ranking for primary keyword"
          example: 3
        keyword_search_volume:
          type: integer
          nullable: true
          minimum: 0
          description: "Monthly search volume for keyword"
          example: 1200
        keyword_difficulty:
          type: integer
          nullable: true
          minimum: 0
          maximum: 100
          description: "Keyword difficulty score (0-100)"
          example: 45

        # Technical SEO Metrics (Performance)
        page_load_speed_ms:
          type: integer
          nullable: true
          minimum: 0
          description: "Page load speed in milliseconds"
          example: 1850
        mobile_friendly_score:
          type: integer
          nullable: true
          minimum: 0
          maximum: 100
          description: "Mobile-friendliness score (0-100)"
          example: 92
        core_web_vitals_score:
          type: integer
          nullable: true
          minimum: 0
          maximum: 100
          description: "Core Web Vitals score (0-100)"
          example: 78

        # Content Analysis Metrics
        content_length:
          type: integer
          nullable: true
          minimum: 0
          description: "Content length in characters"
          example: 2450
        heading_structure:
          type: object
          nullable: true
          description: "Heading structure analysis"
          additionalProperties: true
          example:
            h1_count: 1
            h2_count: 4
            h3_count: 8
            has_proper_hierarchy: true
        internal_links_count:
          type: integer
          minimum: 0
          default: 0
          description: "Number of internal links"
          example: 12
        external_links_count:
          type: integer
          minimum: 0
          default: 0
          description: "Number of external links"
          example: 3

        # Social Signals (Optional Integration)
        social_shares:
          type: integer
          minimum: 0
          default: 0
          description: "Total social media shares"
          example: 45
        social_engagement_rate:
          type: number
          format: decimal
          multipleOf: 0.0001
          minimum: 0
          maximum: 1
          default: 0
          description: "Social engagement rate (0-1)"
          example: 0.0325

        # Temporal Data
        date_recorded:
          type: string
          format: date
          description: "Date when data was recorded"
          example: "2025-11-12"

# SEO Bulk Operations - Enterprise Efficiency (Table 4 of 8)
SEOBulkOperation:
  allOf:
    - $ref: '../common/base.yaml#/BaseEntity'
    - $ref: '../common/base.yaml#/AuditableEntity'
    - $ref: '../common/base.yaml#/AuditEntity'
    - type: object
      required:
        - operation_type
        - operation_name
      properties:
        # Operation Definition
        operation_type:
          type: string
          enum: [bulk_update, bulk_generate, bulk_analyze, bulk_optimize]
          description: "Type of bulk operation"
          example: "bulk_generate"
        operation_name:
          type: string
          maxLength: 255
          description: "Human-readable operation name"
          example: "Generate Meta Tags for All Products"
        operation_description:
          type: string
          nullable: true
          description: "Detailed operation description"
          example: "Auto-generate meta titles and descriptions for all products without existing SEO data"

        # Target Selection (Advanced Filtering)
        target_type:
          type: string
          maxLength: 100
          nullable: true
          description: "Target content type"
          example: "products"
        target_filters:
          type: object
          nullable: true
          description: "Filters for target selection"
          additionalProperties: true
          example:
            category_ids: ["uuid1", "uuid2"]
            price_range:
              min: 50
              max: 500
            has_seo_meta: false
        target_count:
          type: integer
          minimum: 0
          default: 0
          description: "Number of items to process"
          example: 150

        # Operation Configuration
        operation_config:
          type: object
          nullable: true
          description: "Operation-specific settings"
          additionalProperties: true
          example:
            use_ai_generation: true
            overwrite_existing: false
            template_variables:
              brand_name: "Acme Corp"
              location: "Jakarta"
        template_data:
          type: object
          nullable: true
          description: "Templates for bulk generation"
          additionalProperties: true
          example:
            meta_title_template: "{product_name} - Professional {category} | {brand_name}"
            meta_description_template: "High-quality {product_name} at competitive prices. {product_description}"

        # Progress Tracking (Real-time)
        status:
          type: string
          enum: [pending, running, completed, failed, cancelled]
          default: "pending"
          description: "Current operation status"
          example: "running"
        progress_percentage:
          type: integer
          minimum: 0
          maximum: 100
          default: 0
          description: "Progress percentage (0-100)"
          example: 67
        processed_count:
          type: integer
          minimum: 0
          default: 0
          description: "Items processed so far"
          example: 100
        success_count:
          type: integer
          minimum: 0
          default: 0
          description: "Successfully processed items"
          example: 98
        error_count:
          type: integer
          minimum: 0
          default: 0
          description: "Items that failed processing"
          example: 2

        # Results & Logging
        results:
          type: object
          nullable: true
          description: "Operation results summary"
          additionalProperties: true
          example:
            total_processed: 150
            meta_titles_generated: 148
            meta_descriptions_generated: 145
            errors: 2
            processing_time_seconds: 45
        error_log:
          type: array
          items:
            type: object
            properties:
              item_id:
                type: string
                format: uuid
                example: "550e8400-e29b-41d4-a716-446655440000"
              error_message:
                type: string
                example: "Failed to generate meta description: content too short"
              error_code:
                type: string
                example: "CONTENT_TOO_SHORT"
              timestamp:
                type: string
                format: date-time
                example: "2025-11-12T10:15:23Z"
          description: "Detailed error log"

        # Timing Information
        started_at:
          type: string
          format: date-time
          nullable: true
          description: "Operation start timestamp"
          example: "2025-11-12T10:00:00Z"
        completed_at:
          type: string
          format: date-time
          nullable: true
          description: "Operation completion timestamp"
          example: "2025-11-12T10:15:45Z"
        estimated_duration_minutes:
          type: integer
          nullable: true
          minimum: 1
          description: "Estimated duration in minutes"
          example: 15

# ==========================================
# ADVANCED SEO TABLES (5-8 of 8)
# ==========================================

# SEO Sitemap Entries (Table 5 of 8)
SEOSitemapEntry:
  allOf:
    - $ref: '../common/base.yaml#/BaseEntity'
    - $ref: '../common/base.yaml#/AuditableEntity'
    - type: object
      required:
        - url
      properties:
        # URL Information
        url:
          type: string
          maxLength: 1000
          description: "URL for sitemap entry"
          example: "https://acme-etching.com/services/laser-etching"
        canonical_url:
          type: string
          maxLength: 1000
          nullable: true
          description: "Canonical URL if different"
          example: "https://acme-etching.com/services/laser-etching/"

        # Sitemap Properties (XML Sitemap Standard)
        priority:
          type: number
          format: decimal
          minimum: 0.0
          maximum: 1.0
          default: 0.5
          description: "URL priority (0.0-1.0)"
          example: 0.8
        changefreq:
          type: string
          enum: [always, hourly, daily, weekly, monthly, yearly, never]
          default: "weekly"
          description: "How frequently content changes"
          example: "monthly"
        last_modified:
          type: string
          format: date-time
          description: "Last modification timestamp"
          example: "2025-11-12T10:00:00Z"

        # Content Information
        page_type:
          type: string
          maxLength: 100
          nullable: true
          description: "Type of page/content"
          example: "product_page"
        content_type:
          type: string
          maxLength: 100
          nullable: true
          description: "MIME content type"
          example: "text/html"
        language_code:
          type: string
          maxLength: 10
          default: "id"
          description: "Content language"
          example: "id"

        # SEO Metadata (Cached for Performance)
        title:
          type: string
          maxLength: 255
          nullable: true
          description: "Page title for sitemap"
          example: "Laser Etching Services - Professional Precision"
        description:
          type: string
          nullable: true
          description: "Page description for sitemap"
          example: "Premium laser etching services with precision craftsmanship"
        keywords:
          type: string
          nullable: true
          description: "Page keywords for sitemap"
          example: "laser etching, metal engraving, precision cutting"

        # Images in Page (for Image Sitemap)
        images:
          type: array
          items:
            type: object
            properties:
              url:
                type: string
                format: uri
                description: "Image URL"
                example: "https://cdn.acme.com/laser-etching-1.jpg"
              caption:
                type: string
                nullable: true
                description: "Image caption"
                example: "Precision laser etching on stainless steel"
              title:
                type: string
                nullable: true
                description: "Image title"
                example: "Laser Etching Process"
              geo_location:
                type: string
                nullable: true
                description: "Geographic location"
                example: "Jakarta, Indonesia"
              license:
                type: string
                format: uri
                nullable: true
                description: "Image license URL"
                example: "https://creativecommons.org/licenses/by/4.0/"
          description: "Images associated with this page"
          maxItems: 1000

        # Status & Control
        is_active:
          type: boolean
          default: true
          description: "Whether URL is active in sitemap"
        is_indexed:
          type: boolean
          default: false
          description: "Whether URL is indexed by search engines"
        index_status:
          type: string
          enum: [pending, indexed, blocked, error]
          default: "pending"
          description: "Current indexing status"
          example: "indexed"

        # Tracking
        last_crawled:
          type: string
          format: date-time
          nullable: true
          description: "Last crawled by search engines"
          example: "2025-11-11T14:30:00Z"
        crawl_errors:
          type: array
          items:
            type: object
            properties:
              error_type:
                type: string
                example: "404"
              error_message:
                type: string
                example: "Page not found"
              detected_at:
                type: string
                format: date-time
                example: "2025-11-10T09:00:00Z"
          description: "Crawl errors detected"

# SEO Robots.txt Management (Table 6 of 8)
SEORobotsRule:
  allOf:
    - $ref: '../common/base.yaml#/BaseEntity'
    - $ref: '../common/base.yaml#/AuditableEntity'
    - $ref: '../common/base.yaml#/AuditEntity'
    - type: object
      required:
        - user_agent
        - directive
      properties:
        # Robot Identification
        user_agent:
          type: string
          maxLength: 255
          description: "Target user agent (* for all)"
          example: "*"
        directive:
          type: string
          enum: [allow, disallow, sitemap, crawl_delay]
          description: "Robots directive type"
          example: "disallow"
        path:
          type: string
          maxLength: 1000
          nullable: true
          description: "Path pattern for allow/disallow"
          example: "/admin/"
        
        # Directive-Specific Settings
        crawl_delay:
          type: integer
          nullable: true
          minimum: 1
          maximum: 86400
          description: "Crawl delay in seconds (for crawl_delay directive)"
          example: 10
        sitemap_url:
          type: string
          format: uri
          nullable: true
          description: "Sitemap URL (for sitemap directive)"
          example: "https://acme-etching.com/sitemap.xml"

        # Rule Management
        rule_order:
          type: integer
          description: "Rule precedence order"
          default: 0
          example: 1
        is_active:
          type: boolean
          default: true
          description: "Whether rule is active"
        comment:
          type: string
          nullable: true
          description: "Rule description/comment"
          example: "Block access to admin area"

# SEO Redirect Rules (Table 7 of 8)
SEORedirectRule:
  allOf:
    - $ref: '../common/base.yaml#/BaseEntity'
    - $ref: '../common/base.yaml#/AuditableEntity'
    - $ref: '../common/base.yaml#/AuditEntity'
    - type: object
      required:
        - source_url
        - target_url
        - redirect_type
      properties:
        # URL Mapping
        source_url:
          type: string
          maxLength: 1000
          description: "Source URL pattern"
          example: "/old-services"
        target_url:
          type: string
          maxLength: 1000
          description: "Target URL"
          example: "/services"
        
        # Redirect Configuration
        redirect_type:
          type: string
          enum: ["301", "302", "307", "308"]
          description: "HTTP redirect status code"
          example: "301"
        is_regex:
          type: boolean
          default: false
          description: "Whether source URL is regex pattern"
        is_active:
          type: boolean
          default: true
          description: "Whether redirect rule is active"
        
        # Tracking & Analytics
        hit_count:
          type: integer
          minimum: 0
          default: 0
          description: "Number of times redirect was triggered"
          example: 150
        last_hit:
          type: string
          format: date-time
          nullable: true
          description: "Last time redirect was triggered"
          example: "2025-11-12T08:45:00Z"
        
        # Rule Management
        rule_order:
          type: integer
          description: "Rule precedence order"
          default: 0
          example: 1
        description:
          type: string
          nullable: true
          description: "Redirect rule description"
          example: "Redirect old services page to new services page"

# SEO Performance Reports (Table 8 of 8)
SEOPerformanceReport:
  allOf:
    - $ref: '../common/base.yaml#/BaseEntity'
    - $ref: '../common/base.yaml#/AuditableEntity'
    - $ref: '../common/base.yaml#/AuditEntity'
    - type: object
      required:
        - report_type
        - date_range_start
        - date_range_end
      properties:
        # Report Configuration
        report_type:
          type: string
          enum: [overview, keywords, pages, technical, competitors]
          description: "Type of SEO report"
          example: "overview"
        report_name:
          type: string
          maxLength: 255
          description: "Human-readable report name"
          example: "Monthly SEO Overview - November 2025"
        
        # Date Range
        date_range_start:
          type: string
          format: date
          description: "Report start date"
          example: "2025-11-01"
        date_range_end:
          type: string
          format: date
          description: "Report end date"
          example: "2025-11-30"
        
        # Report Data (Comprehensive)
        report_data:
          type: object
          description: "Complete report data"
          additionalProperties: true
          example:
            overview:
              total_impressions: 15420
              total_clicks: 1340
              average_ctr: 8.7
              average_position: 4.2
              top_keywords: ["laser etching", "metal engraving", "custom fabrication"]
            performance_summary:
              pages_improved: 12
              pages_declined: 3
              new_rankings: 8
              lost_rankings: 2
        
        # Report Metrics
        total_pages_analyzed:
          type: integer
          minimum: 0
          description: "Number of pages analyzed"
          example: 45
        total_keywords_tracked:
          type: integer
          minimum: 0
          description: "Number of keywords tracked"
          example: 150
        overall_seo_score:
          type: integer
          minimum: 0
          maximum: 100
          description: "Overall SEO health score"
          example: 78
        
        # Trend Analysis
        performance_trend:
          type: string
          enum: [improving, stable, declining]
          description: "Overall performance trend"
          example: "improving"
        key_improvements:
          type: array
          items:
            type: string
          description: "Key improvements identified"
          example: ["Meta descriptions added to 12 pages", "Page load speed improved by 15%"]
        
        # Action Items
        recommended_actions:
          type: array
          items:
            type: object
            properties:
              category:
                type: string
                example: "technical"
              priority:
                type: string
                enum: [low, medium, high, critical]
                example: "high"
              action:
                type: string
                example: "Fix broken internal links"
              estimated_impact:
                type: string
                enum: [low, medium, high]
                example: "medium"
              effort_required:
                type: string
                enum: [low, medium, high]
                example: "low"
          description: "Recommended SEO actions"
        
        # Report Status
        generation_status:
          type: string
          enum: [generating, completed, failed]
          default: "generating"
          description: "Report generation status"
          example: "completed"
        report_file_url:
          type: string
          format: uri
          nullable: true
          description: "URL to download full report (PDF/Excel)"
          example: "https://cdn.acme.com/reports/seo-nov-2025.pdf"

# ==========================================
# REQUEST/RESPONSE SCHEMAS
# ==========================================

# SEO Settings Update Request
UpdateSEOSettingsRequest:
  type: object
  properties:
    site_name:
      type: string
      maxLength: 255
      example: "Updated Site Name"
    default_meta_title:
      type: string
      maxLength: 255
      example: "{page} | {site_name} | Professional Services"
    default_meta_description:
      type: string
      example: "Updated default description with better keywords"
    enable_ai_optimization:
      type: boolean
      example: true
    google_analytics_id:
      type: string
      maxLength: 50
      nullable: true
      example: "GA_MEASUREMENT_ID_UPDATED"

# SEO Meta Create Request
CreateSEOMetaRequest:
  type: object
  required:
    - seo_metable_type
    - seo_metable_id
  properties:
    seo_metable_type:
      type: string
      maxLength: 255
      example: "App\\Models\\Product"
    seo_metable_id:
      type: string
      format: uuid
      example: "550e8400-e29b-41d4-a716-446655440000"
    meta_title:
      type: string
      maxLength: 255
      nullable: true
      example: "Premium Laser Etching Services"
    meta_description:
      type: string
      nullable: true
      example: "Professional laser etching with precision and quality"
    use_ai_generation:
      type: boolean
      default: false
      description: "Use AI to generate meta tags"
      example: true

# Bulk SEO Operation Request
CreateBulkSEOOperationRequest:
  type: object
  required:
    - operation_type
    - operation_name
    - target_type
  properties:
    operation_type:
      type: string
      enum: [bulk_update, bulk_generate, bulk_analyze, bulk_optimize]
      example: "bulk_generate"
    operation_name:
      type: string
      maxLength: 255
      example: "Generate Meta Tags for Products"
    target_type:
      type: string
      example: "products"
    target_filters:
      type: object
      additionalProperties: true
      example:
        category_ids: ["uuid1", "uuid2"]
        has_seo_meta: false
    use_ai_generation:
      type: boolean
      default: false
      example: true
    overwrite_existing:
      type: boolean
      default: false
      example: false

# SEO Analytics Report Response
SEOAnalyticsResponse:
  type: object
  properties:
    summary:
      type: object
      properties:
        total_pages:
          type: integer
          example: 45
        pages_with_seo:
          type: integer
          example: 38
        average_seo_score:
          type: number
          format: decimal
          example: 78.5
        total_impressions:
          type: integer
          example: 15420
        total_clicks:
          type: integer
          example: 1340
        average_ctr:
          type: number
          format: decimal
          example: 8.7
    top_performing_pages:
      type: array
      items:
        type: object
        properties:
          url:
            type: string
            example: "https://acme-etching.com/services/laser"
          title:
            type: string
            example: "Laser Etching Services"
          impressions:
            type: integer
            example: 2500
          clicks:
            type: integer
            example: 220
          ctr:
            type: number
            format: decimal
            example: 8.8
          position:
            type: number
            format: decimal
            example: 3.2
    improvement_opportunities:
      type: array
      items:
        type: object
        properties:
          page_url:
            type: string
            example: "https://acme-etching.com/about"
          issue:
            type: string
            example: "Missing meta description"
          impact:
            type: string
            enum: [low, medium, high]
            example: "high"
          solution:
            type: string
            example: "Add compelling meta description"

# Error Responses
SEOError:
  allOf:
    - $ref: '../common/base.yaml#/ErrorResponse'
    - type: object
      properties:
        error_code:
          type: string
          enum: [
            SEO_SETTINGS_NOT_FOUND,
            SEO_META_NOT_FOUND,
            INVALID_METABLE_TYPE,
            BULK_OPERATION_FAILED,
            AI_GENERATION_FAILED,
            SITEMAP_GENERATION_FAILED,
            ANALYTICS_SYNC_FAILED
          ]
          example: "SEO_META_NOT_FOUND"
        details:
          type: object
          nullable: true
          example:
            seo_metable_type: "App\\Models\\Product"
            seo_metable_id: "550e8400-e29b-41d4-a716-446655440000"
        schemaType:
          type: string
          maxLength: 50
          description: Schema.org type for structured data
          example: "Organization"
          nullable: true
        schemaData:
          type: object
          description: Custom Schema.org JSON-LD data
          nullable: true
          additionalProperties: true
        customMetaTags:
          type: object
          description: Additional custom meta tags as key-value pairs
          nullable: true
          additionalProperties:
            type: string
          example:
            "theme-color": "#007bff"
            "msapplication-TileColor": "#007bff"
        isEnabled:
          type: boolean
          default: true
          description: Whether custom SEO is active for this item
        priority:
          type: number
          format: float
          minimum: 0.0
          maximum: 1.0
          default: 0.5
          description: Sitemap priority (0.0-1.0)
        changeFreq:
          type: string
          enum: ['always', 'hourly', 'daily', 'weekly', 'monthly', 'yearly', 'never']
          default: 'weekly'
          description: Sitemap change frequency

# Default Open Graph Settings
DefaultOpenGraphSettings:
  type: object
  properties:
    type:
      type: string
      enum: ['website', 'article', 'product']
      default: 'website'
      description: Default OG type
    siteName:
      type: string
      maxLength: 255
      description: Site name for Open Graph
      example: "Stencil CMS"
    defaultImageUrl:
      type: string
      format: uri
      maxLength: 500
      description: Default OG image URL (fallback)
      example: "/images/og-default.jpg"
    locale:
      type: string
      enum: ['id_ID', 'en_US']
      default: 'id_ID'
      description: Default locale for content
    twitterSite:
      type: string
      maxLength: 50
      description: Twitter site handle
      example: "@stencilcms"
      nullable: true

# Default Twitter Settings
DefaultTwitterSettings:
  type: object
  properties:
    cardType:
      type: string
      enum: ['summary', 'summary_large_image']
      default: 'summary_large_image'
      description: Default Twitter Card type
    site:
      type: string
      maxLength: 50
      description: Twitter site handle
      example: "@stencilcms"
      nullable: true
    creator:
      type: string
      maxLength: 50
      description: Default Twitter creator handle
      example: "@stencilcms"
      nullable: true

# Default Schema.org Settings
DefaultSchemaOrgSettings:
  type: object
  properties:
    type:
      type: string
      maxLength: 50
      description: Default Schema.org type
      example: "Organization"
    data:
      type: object
      description: Default Schema.org JSON-LD structure
      additionalProperties: true
      example:
        "@context": "https://schema.org"
        "@type": "Organization"
        "name": "Stencil CMS"
        "url": "https://stencilcms.com"

# Default Robots Settings
DefaultRobotsSettings:
  type: object
  properties:
    default:
      type: string
      pattern: '^(index|noindex),\s*(follow|nofollow)$'
      default: 'index, follow'
      description: Default robots directive
    allowSearchEngines:
      type: boolean
      default: true
      description: Whether to allow search engine indexing globally
    customDirectives:
      type: array
      description: Custom robots.txt directives
      items:
        type: string
      example:
        - "Disallow: /admin/"
        - "Disallow: /api/"

# Search Engine Verification
SearchEngineVerification:
  type: object
  properties:
    googleSiteVerification:
      type: string
      maxLength: 100
      description: Google Search Console verification code
      example: "abc123xyz"
      nullable: true
    bingSiteVerification:
      type: string
      maxLength: 100
      description: Bing Webmaster Tools verification code
      example: "def456uvw"
      nullable: true
    yandexVerification:
      type: string
      maxLength: 100
      description: Yandex Webmaster verification code
      nullable: true
    baiduVerification:
      type: string
      maxLength: 100
      description: Baidu verification code
      nullable: true

# Social Media Links
SocialMediaLinks:
  type: object
  properties:
    facebook:
      type: string
      format: uri
      maxLength: 500
      description: Facebook page URL
      example: "https://facebook.com/stencilcms"
      nullable: true
    instagram:
      type: string
      format: uri
      maxLength: 500
      description: Instagram profile URL
      example: "https://instagram.com/stencilcms"
      nullable: true
    twitter:
      type: string
      format: uri
      maxLength: 500
      description: Twitter profile URL
      example: "https://twitter.com/stencilcms"
      nullable: true
    linkedin:
      type: string
      format: uri
      maxLength: 500
      description: LinkedIn company page URL
      example: "https://linkedin.com/company/stencilcms"
      nullable: true
    youtube:
      type: string
      format: uri
      maxLength: 500
      description: YouTube channel URL
      example: "https://youtube.com/c/stencilcms"
      nullable: true

# Open Graph Meta Tags (for specific items)
OpenGraphMeta:
  type: object
  properties:
    title:
      type: string
      maxLength: 60
      description: OG title (60 chars recommended)
      example: "About Us - Stencil CMS"
      nullable: true
    description:
      type: string
      maxLength: 160
      description: OG description (160 chars recommended)
      example: "Learn about our company"
      nullable: true
    image:
      type: string
      format: uri
      maxLength: 500
      description: OG image URL
      example: "/images/og-about.jpg"
      nullable: true
    imageAlt:
      type: string
      maxLength: 125
      description: OG image alt text
      example: "Company office building"
      nullable: true
    type:
      type: string
      enum: ['website', 'article', 'product']
      default: 'website'
      description: OG content type
    url:
      type: string
      format: uri
      maxLength: 500
      description: Canonical OG URL
      example: "https://stencilcms.com/about"
      nullable: true
    siteName:
      type: string
      maxLength: 255
      description: Site name for OG
      example: "Stencil CMS"
      nullable: true
    locale:
      type: string
      enum: ['id_ID', 'en_US']
      description: Content locale
      nullable: true

# Twitter Card Meta Tags (for specific items)
TwitterCardMeta:
  type: object
  properties:
    card:
      type: string
      enum: ['summary', 'summary_large_image']
      default: 'summary_large_image'
      description: Twitter Card type
    title:
      type: string
      maxLength: 60
      description: Twitter Card title
      example: "About Us - Stencil CMS"
      nullable: true
    description:
      type: string
      maxLength: 160
      description: Twitter Card description
      example: "Learn about our company"
      nullable: true
    image:
      type: string
      format: uri
      maxLength: 500
      description: Twitter Card image URL
      example: "/images/twitter-about.jpg"
      nullable: true
    imageAlt:
      type: string
      maxLength: 420
      description: Twitter Card image alt text
      example: "Company office building"
      nullable: true
    site:
      type: string
      maxLength: 50
      pattern: '^@[A-Za-z0-9_]+$'
      description: Twitter site handle (with @)
      example: "@stencilcms"
      nullable: true
    creator:
      type: string
      maxLength: 50
      pattern: '^@[A-Za-z0-9_]+$'
      description: Twitter creator handle (with @)
      example: "@stencilcms"
      nullable: true

# Input DTOs

# Default SEO Settings Input
DefaultSEOSettingsInput:
  type: object
  required:
    - siteName
    - defaultMetaTitle
    - defaultMetaDescription
  properties:
    siteName:
      type: string
      maxLength: 255
      minLength: 1
      description: Site name
    defaultMetaTitle:
      type: string
      maxLength: 255
      minLength: 1
      description: Default meta title template
    defaultMetaDescription:
      type: string
      maxLength: 500
      minLength: 1
      description: Default meta description
    defaultMetaKeywords:
      type: string
      maxLength: 500
      description: Default meta keywords
      nullable: true
    openGraph:
      type: object
      properties:
        type:
          type: string
          enum: ['website', 'article', 'product']
        siteName:
          type: string
          maxLength: 255
        defaultImageUrl:
          type: string
          format: uri
          maxLength: 500
        locale:
          type: string
          enum: ['id_ID', 'en_US']
        twitterSite:
          type: string
          maxLength: 50
    twitter:
      type: object
      properties:
        cardType:
          type: string
          enum: ['summary', 'summary_large_image']
        site:
          type: string
          maxLength: 50
        creator:
          type: string
          maxLength: 50
    schemaOrg:
      type: object
      properties:
        type:
          type: string
          maxLength: 50
        data:
          type: object
          additionalProperties: true
    robots:
      type: object
      properties:
        default:
          type: string
          pattern: '^(index|noindex),\s*(follow|nofollow)$'
        allowSearchEngines:
          type: boolean
        customDirectives:
          type: array
          items:
            type: string
    canonicalBaseUrl:
      type: string
      format: uri
      maxLength: 500
    verification:
      type: object
      properties:
        googleSiteVerification:
          type: string
          maxLength: 100
        bingSiteVerification:
          type: string
          maxLength: 100
        yandexVerification:
          type: string
          maxLength: 100
        baiduVerification:
          type: string
          maxLength: 100
    socialMedia:
      type: object
      properties:
        facebook:
          type: string
          format: uri
          maxLength: 500
        instagram:
          type: string
          format: uri
          maxLength: 500
        twitter:
          type: string
          format: uri
          maxLength: 500
        linkedin:
          type: string
          format: uri
          maxLength: 500
        youtube:
          type: string
          format: uri
          maxLength: 500

# SEO Meta Input
SEOMetaInput:
  type: object
  properties:
    metaTitle:
      type: string
      maxLength: 60
      description: Custom page title
    metaDescription:
      type: string
      maxLength: 160
      description: Custom meta description
    metaKeywords:
      type: string
      maxLength: 500
      description: Custom meta keywords
    ogTitle:
      type: string
      maxLength: 60
      description: Open Graph title
    ogDescription:
      type: string
      maxLength: 160
      description: Open Graph description
    ogImageUrl:
      type: string
      format: uri
      maxLength: 500
      description: Open Graph image URL
    ogImageAlt:
      type: string
      maxLength: 125
      description: Open Graph image alt text
    ogType:
      type: string
      enum: ['website', 'article', 'product']
      description: Open Graph type
    twitterTitle:
      type: string
      maxLength: 60
      description: Twitter Card title
    twitterDescription:
      type: string
      maxLength: 160
      description: Twitter Card description
    twitterImageUrl:
      type: string
      format: uri
      maxLength: 500
      description: Twitter Card image URL
    twitterImageAlt:
      type: string
      maxLength: 420
      description: Twitter Card image alt text
    twitterCardType:
      type: string
      enum: ['summary', 'summary_large_image']
      description: Twitter Card type
    canonicalUrl:
      type: string
      format: uri
      maxLength: 500
      description: Canonical URL
    robots:
      type: string
      pattern: '^(index|noindex),\s*(follow|nofollow)$'
      example: "index, follow"
      description: Robots meta directive
    schemaType:
      type: string
      maxLength: 50
      description: Schema.org type
    schemaData:
      type: object
      additionalProperties: true
      description: Schema.org JSON-LD data
    customMetaTags:
      type: object
      additionalProperties:
        type: string
      description: Custom meta tags
    isEnabled:
      type: boolean
      default: true
      description: Whether SEO is enabled
    priority:
      type: number
      format: float
      minimum: 0.0
      maximum: 1.0
      description: Sitemap priority
    changeFreq:
      type: string
      enum: ['always', 'hourly', 'daily', 'weekly', 'monthly', 'yearly', 'never']
      description: Sitemap change frequency

# Response DTOs

# SEO Metadata Response (Public API)
SEOMetadataResponse:
  type: object
  properties:
    success:
      type: boolean
      example: true
    data:
      type: object
      properties:
        title:
          type: string
          example: "About Us - Stencil CMS"
          description: Page title (max 60 chars recommended)
        metaDescription:
          type: string
          example: "Learn about our company, mission, and team"
          description: Meta description (max 160 chars recommended)
        metaKeywords:
          type: array
          items:
            type: string
          example: ["about", "company", "team"]
          description: Meta keywords as array
        canonicalUrl:
          type: string
          format: uri
          example: "https://stencilcms.com/about"
          description: Canonical URL for the page
        robots:
          type: string
          example: "index, follow"
          description: Robots meta directive
        openGraph:
          $ref: '#/OpenGraphMeta'
          description: Open Graph meta tags
        twitter:
          $ref: '#/TwitterCardMeta'
          description: Twitter Card meta tags
        schema:
          type: object
          description: Schema.org JSON-LD data
          additionalProperties: true
          example:
            "@context": "https://schema.org"
            "@type": "Organization"
            "name": "Stencil CMS"
        customMetaTags:
          type: object
          additionalProperties:
            type: string
          description: Additional custom meta tags
          example:
            "theme-color": "#007bff"
        source:
          type: string
          enum: ['custom', 'default', 'system']
          example: "custom"
          description: Source of SEO data (custom/default/system)
    meta:
      type: object
      properties:
        generated_at:
          type: string
          format: date-time
        cache_duration:
          type: integer
          description: Cache duration in seconds
          example: 3600

# Sitemap Entry
SitemapEntry:
  type: object
  properties:
    loc:
      type: string
      format: uri
      description: URL location
    lastmod:
      type: string
      format: date
      description: Last modification date
    changefreq:
      type: string
      enum: ['always', 'hourly', 'daily', 'weekly', 'monthly', 'yearly', 'never']
      description: Change frequency
    priority:
      type: number
      format: float
      minimum: 0.0
      maximum: 1.0
      description: Priority (0.0-1.0)

# Robots.txt Configuration
RobotsTxtConfig:
  type: object
  properties:
    userAgent:
      type: string
      default: "*"
      description: User agent directive
    allow:
      type: array
      items:
        type: string
      description: Allowed paths
    disallow:
      type: array
      items:
        type: string
      description: Disallowed paths
      example: ["/admin/", "/api/"]
    sitemap:
      type: string
      format: uri
      description: Sitemap URL
      example: "https://stencilcms.com/sitemap.xml"
    crawlDelay:
      type: integer
      minimum: 0
      description: Crawl delay in seconds
      nullable: true