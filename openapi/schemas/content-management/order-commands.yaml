# Order Command DTOs for Phase 4C
# Request/Command schemas for order business workflow commands

# Create Purchase Order Command DTO
CreatePurchaseOrderCommand:
  type: object
  required:
    - customer_name
    - customer_email
    - customer_phone
    - items
    - shipping_address
  properties:
    customer_name:
      type: string
      minLength: 1
      maxLength: 255
      description: Customer full name
    customer_email:
      type: string
      format: email
      description: Customer email address
    customer_phone:
      type: string
      minLength: 10
      maxLength: 20
      description: Customer phone number
    customer_company:
      type: string
      maxLength: 255
      description: Customer company name
    items:
      type: array
      minItems: 1
      items:
        type: object
        required:
          - product_name
          - quantity
        properties:
          product_name:
            type: string
            description: Product or service name
          quantity:
            type: integer
            minimum: 1
          customization:
            type: object
            additionalProperties: true
          design_file_url:
            type: string
            format: uri
    shipping_address:
      type: object
      required:
        - address
        - city
        - province
        - postal_code
      properties:
        address:
          type: string
        city:
          type: string
        province:
          type: string
        postal_code:
          type: string
        country:
          type: string
          default: Indonesia
    priority:
      type: string
      enum: [normal, high, urgent]
      default: normal
    idempotency_key:
      type: string
      format: uuid
      description: Idempotency key for duplicate prevention

# Assign Vendor Command DTO
AssignVendorCommand:
  type: object
  required:
    - order_id
    - vendor_id
  properties:
    order_id:
      type: integer
      description: Order ID
    vendor_id:
      type: integer
      description: Vendor ID to assign
    notes:
      type: string
      description: Assignment notes
    idempotency_key:
      type: string
      format: uuid

# Negotiate Price Command DTO
NegotiatePriceCommand:
  type: object
  required:
    - order_id
    - vendor_id
    - vendor_price
  properties:
    order_id:
      type: integer
    vendor_id:
      type: integer
    vendor_price:
      type: number
      format: double
      multipleOf: 0.01
      minimum: 0
      description: Price from vendor
    markup_percentage:
      type: number
      format: double
      multipleOf: 0.01
      minimum: 0
      maximum: 100
      description: Markup percentage for customer price
    notes:
      type: string
    deadline_days:
      type: integer
      minimum: 1
      default: 7
    idempotency_key:
      type: string
      format: uuid

# Approve Quote Command DTO
ApproveQuoteCommand:
  type: object
  required:
    - order_id
    - approved_by_customer
  properties:
    order_id:
      type: integer
    approved_by_customer:
      type: boolean
      description: Is quote approved by customer
    customer_approval_notes:
      type: string
    idempotency_key:
      type: string
      format: uuid

# Verify Payment Command DTO
VerifyPaymentCommand:
  type: object
  required:
    - order_id
    - amount
    - payment_method
  properties:
    order_id:
      type: integer
    amount:
      type: number
      format: double
      multipleOf: 0.01
      minimum: 0
    payment_method:
      type: string
      enum: [cash, bank_transfer, payment_gateway]
    payment_date:
      type: string
      format: date
    reference_number:
      type: string
      description: Payment reference/transaction ID
    notes:
      type: string
    idempotency_key:
      type: string
      format: uuid

# Update Production Command DTO
UpdateProductionCommand:
  type: object
  required:
    - order_id
    - production_status
  properties:
    order_id:
      type: integer
    production_status:
      type: string
      enum: [in_production, quality_check, ready_to_ship]
    milestone:
      type: string
      description: Production milestone
    progress_percentage:
      type: integer
      minimum: 0
      maximum: 100
    notes:
      type: string
    attachments:
      type: array
      items:
        type: string
        format: uri
    idempotency_key:
      type: string
      format: uuid

# Ship Order Command DTO
ShipOrderCommand:
  type: object
  required:
    - order_id
    - shipping_carrier
  properties:
    order_id:
      type: integer
    shipping_carrier:
      type: string
      description: Shipping carrier name (JNE, Tiki, etc.)
    tracking_number:
      type: string
      description: Tracking number
    estimated_delivery:
      type: string
      format: date
    shipping_cost:
      type: number
      format: double
      multipleOf: 0.01
    notes:
      type: string
    idempotency_key:
      type: string
      format: uuid

# Complete Order Command DTO
CompleteOrderCommand:
  type: object
  required:
    - order_id
  properties:
    order_id:
      type: integer
    delivery_date:
      type: string
      format: date
    notes:
      type: string
    require_customer_review:
      type: boolean
      default: true
    idempotency_key:
      type: string
      format: uuid

# Cancel Order Command DTO
CancelOrderCommand:
  type: object
  required:
    - order_id
    - reason
  properties:
    order_id:
      type: integer
    reason:
      type: string
      enum: [customer_request, inventory_issue, payment_failed, system_error, other]
    notes:
      type: string
    process_refund:
      type: boolean
      default: true
    idempotency_key:
      type: string
      format: uuid

# Command Status Response
CommandStatusResponse:
  type: object
  properties:
    command_id:
      type: string
      format: uuid
    command_type:
      type: string
      description: Type of command executed
    status:
      type: string
      enum: [pending, processing, completed, failed]
    order_id:
      type: integer
      description: Associated order ID
    created_at:
      type: string
      format: date-time
    started_at:
      type: string
      format: date-time
    completed_at:
      type: string
      format: date-time
    result:
      type: object
      additionalProperties: true
      description: Command execution result
    error:
      type: object
      properties:
        code:
          type: string
        message:
          type: string
        details:
          type: object
