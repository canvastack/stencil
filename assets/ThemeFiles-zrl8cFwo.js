import{j as e}from"./ui-vendor-CJNjIdOR.js";import{as as B,C as L,a as Q,b as I,c as A,B as n,aA as O,aB as R,N as W,Y as _,P as G,O as H,Q as Y,R as q,Z as K,L as v,I as x,g as V,d as Z,_ as J,j as X,e as u,an as g,a0 as j,s as ee}from"./index-Dj8ncPAG.js";import{r as f,c as se}from"./react-vendor-92AQlTAG.js";import{P as te}from"./progress-CY2a3gIY.js";import{F}from"./folder-1Vw8Ks7A.js";import{U as P}from"./upload-CustQslt.js";import{S as ae}from"./square-pen-BE2YbwJO.js";import{D as ie}from"./download-C93Gk9fO.js";import{E as le}from"./ellipsis-vertical-DyVpvsM3.js";import{F as re}from"./file-BJEQLgnU.js";import"./three-vendor-CVohgf7y.js";const T={"image/jpeg":u,"image/png":u,"image/gif":u,"image/svg+xml":u,"text/css":g,"text/javascript":j,"application/javascript":j,"text/typescript":j,"application/json":g,"text/html":j,"text/markdown":g,"text/plain":g,folder:F,default:re};function ne(){const{currentTheme:c,currentThemeName:h}=B(),[i,r]=f.useState({files:[],currentPath:"/",selectedFiles:[],viewMode:"grid",searchQuery:"",uploadProgress:0,isUploading:!1}),[m,C]=f.useState(""),[E,y]=f.useState(!1);f.useEffect(()=>{if(c){const s=[];s.push({id:"components",name:"components",path:"/components",type:"folder",lastModified:new Date}),s.push({id:"assets",name:"assets",path:"/assets",type:"folder",lastModified:new Date}),s.push({id:"styles",name:"styles",path:"/styles",type:"folder",lastModified:new Date}),s.push({id:"theme-json",name:"theme.json",path:"/theme.json",type:"file",size:1024,mimeType:"application/json",lastModified:new Date,isEditable:!0}),s.push({id:"index-ts",name:"index.ts",path:"/index.ts",type:"file",size:2048,mimeType:"text/typescript",lastModified:new Date,isEditable:!0}),s.push({id:"readme",name:"README.md",path:"/README.md",type:"file",size:1536,mimeType:"text/markdown",lastModified:new Date,isEditable:!0}),Object.keys(c.components).forEach((t,l)=>{s.push({id:`component-${t}`,name:`${t}.tsx`,path:`/components/${t}.tsx`,type:"file",size:1024+Math.random()*2048,mimeType:"text/typescript",lastModified:new Date,isEditable:!0})}),[{name:"logo.png",type:"image/png",size:15360},{name:"hero-bg.jpg",type:"image/jpeg",size:204800},{name:"icon-sprite.svg",type:"image/svg+xml",size:8192},{name:"main.css",type:"text/css",size:4096},{name:"components.css",type:"text/css",size:2048}].forEach((t,l)=>{const o=t.type.startsWith("image/")?"assets":"styles";s.push({id:`asset-${l}`,name:t.name,path:`/${o}/${t.name}`,type:"file",size:t.size,mimeType:t.type,lastModified:new Date,isEditable:t.type.startsWith("text/"),thumbnail:t.type.startsWith("image/")?`/themes/${h}/assets/${t.name}`:void 0})}),r(t=>({...t,files:s}))}},[c,h]);const k=()=>i.files.filter(a=>{const t=i.currentPath==="/"?!a.path.includes("/",1)||a.path==="/":a.path.startsWith(i.currentPath),l=!i.searchQuery||a.name.toLowerCase().includes(i.searchQuery.toLowerCase());return t&&l}).sort((a,t)=>a.type!==t.type?a.type==="folder"?-1:1:a.name.localeCompare(t.name)),b=s=>T[s.mimeType]||T.default,M=s=>{if(s===0)return"0 Bytes";const a=1024,t=["Bytes","KB","MB","GB"],l=Math.floor(Math.log(s)/Math.log(a));return parseFloat((s/Math.pow(a,l)).toFixed(2))+" "+t[l]},p=(s,a=!1)=>{r(t=>{if(a){const l=t.selectedFiles.includes(s)?t.selectedFiles.filter(o=>o!==s):[...t.selectedFiles,s];return{...t,selectedFiles:l}}else return{...t,selectedFiles:[s]}})},D=s=>{r(a=>({...a,currentPath:s,selectedFiles:[]}))},z=async s=>{const a=Array.from(s.target.files||[]);if(a.length!==0){r(t=>({...t,isUploading:!0,uploadProgress:0}));try{for(let t=0;t<a.length;t++){const l=a[t];for(let d=0;d<=100;d+=10)r(w=>({...w,uploadProgress:d})),await new Promise(w=>setTimeout(w,50));const o={id:`uploaded-${Date.now()}-${t}`,name:l.name,path:`${i.currentPath}${l.name}`,type:"file",size:l.size,mimeType:l.type,lastModified:new Date,isEditable:l.type.startsWith("text/")||l.type==="application/json",thumbnail:l.type.startsWith("image/")?URL.createObjectURL(l):void 0};r(d=>({...d,files:[...d.files,o]}))}r(t=>({...t,isUploading:!1,uploadProgress:0}))}catch(t){console.error("Upload failed:",t),r(l=>({...l,isUploading:!1,uploadProgress:0}))}}},$=()=>{if(!m.trim())return;const s={id:`folder-${Date.now()}`,name:m,path:`${i.currentPath}${m}`,type:"folder",lastModified:new Date};r(a=>({...a,files:[...a.files,s]})),C(""),y(!1)},S=()=>{i.selectedFiles.length!==0&&confirm(`Are you sure you want to delete ${i.selectedFiles.length} item(s)?`)&&r(s=>({...s,files:s.files.filter(a=>!s.selectedFiles.includes(a.id)),selectedFiles:[]}))},U=()=>{const s=i.currentPath.split("/").filter(Boolean);s.pop();const a="/"+s.join("/");r(t=>({...t,currentPath:a==="/"?"/":a,selectedFiles:[]}))},N=k();return e.jsx("div",{className:"space-y-4",children:e.jsxs(L,{children:[e.jsx(Q,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-5 w-5"}),"File Manager"]}),e.jsx(A,{children:"Manage theme files and assets"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center border rounded-md",children:[e.jsx(n,{variant:i.viewMode==="grid"?"default":"ghost",size:"sm",onClick:()=>r(s=>({...s,viewMode:"grid"})),children:e.jsx(O,{className:"h-4 w-4"})}),e.jsx(n,{variant:i.viewMode==="list"?"default":"ghost",size:"sm",onClick:()=>r(s=>({...s,viewMode:"list"})),children:e.jsx(R,{className:"h-4 w-4"})})]}),e.jsxs(W,{open:E,onOpenChange:y,children:[e.jsx(_,{asChild:!0,children:e.jsxs(n,{variant:"outline",size:"sm",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"New Folder"]})}),e.jsxs(H,{children:[e.jsxs(Y,{children:[e.jsx(q,{children:"Create New Folder"}),e.jsx(K,{children:"Enter a name for the new folder"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(v,{htmlFor:"folder-name",children:"Folder Name"}),e.jsx(x,{id:"folder-name",value:m,onChange:s=>C(s.target.value),placeholder:"Enter folder name"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(n,{variant:"outline",onClick:()=>y(!1),children:"Cancel"}),e.jsx(n,{onClick:$,disabled:!m.trim(),children:"Create"})]})]})]})]}),e.jsxs(v,{htmlFor:"file-upload",className:"cursor-pointer",children:[e.jsx(x,{id:"file-upload",type:"file",multiple:!0,onChange:z,className:"hidden"}),e.jsx(n,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs("span",{children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Upload"]})})]}),i.selectedFiles.length>0&&e.jsxs(n,{variant:"outline",size:"sm",onClick:S,children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Delete (",i.selectedFiles.length,")"]})]})]})}),e.jsxs(Z,{children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{variant:"outline",size:"sm",onClick:U,disabled:i.currentPath==="/",children:"â† Back"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:i.currentPath})]}),e.jsx("div",{className:"flex-1 max-w-sm",children:e.jsxs("div",{className:"relative",children:[e.jsx(J,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(x,{placeholder:"Search files...",value:i.searchQuery,onChange:s=>r(a=>({...a,searchQuery:s.target.value})),className:"pl-10"})]})})]}),i.isUploading&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-2",children:[e.jsx("span",{children:"Uploading files..."}),e.jsxs("span",{children:[i.uploadProgress,"%"]})]}),e.jsx(te,{value:i.uploadProgress,className:"h-2"})]}),i.viewMode==="grid"?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:N.map(s=>{const a=b(s),t=i.selectedFiles.includes(s.id);return e.jsx("div",{className:`p-3 border rounded-lg cursor-pointer transition-all hover:shadow-md ${t?"ring-2 ring-primary bg-primary/5":""}`,onClick:()=>s.type==="folder"?D(s.path):p(s.id),onDoubleClick:()=>s.type==="file"&&p(s.id),children:e.jsxs("div",{className:"flex flex-col items-center text-center space-y-2",children:[s.thumbnail?e.jsx("img",{src:s.thumbnail,alt:s.name,className:"w-12 h-12 object-cover rounded"}):e.jsx(a,{className:"h-12 w-12 text-muted-foreground"}),e.jsxs("div",{className:"w-full",children:[e.jsx("p",{className:"text-sm font-medium truncate",title:s.name,children:s.name}),s.size&&e.jsx("p",{className:"text-xs text-muted-foreground",children:M(s.size)})]})]})},s.id)})}):e.jsx("div",{className:"space-y-1",children:N.map(s=>{var l;const a=b(s),t=i.selectedFiles.includes(s.id);return e.jsxs("div",{className:`flex items-center gap-3 p-2 rounded-lg cursor-pointer transition-all hover:bg-muted/50 ${t?"bg-primary/5 ring-1 ring-primary":""}`,onClick:()=>s.type==="folder"?D(s.path):p(s.id),children:[e.jsx("input",{type:"checkbox",checked:t,onChange:o=>{o.stopPropagation(),p(s.id,!0)},className:"rounded"}),s.thumbnail?e.jsx("img",{src:s.thumbnail,alt:s.name,className:"w-8 h-8 object-cover rounded"}):e.jsx(a,{className:"h-8 w-8 text-muted-foreground"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:s.name}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[s.size&&e.jsx("span",{children:M(s.size)}),s.lastModified&&e.jsx("span",{children:s.lastModified.toLocaleDateString()}),s.mimeType&&e.jsx(X,{variant:"outline",className:"text-xs",children:(l=s.mimeType.split("/")[1])==null?void 0:l.toUpperCase()})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[s.isEditable&&e.jsx(n,{variant:"ghost",size:"sm",children:e.jsx(ae,{className:"h-4 w-4"})}),e.jsx(n,{variant:"ghost",size:"sm",children:e.jsx(ie,{className:"h-4 w-4"})}),e.jsx(n,{variant:"ghost",size:"sm",children:e.jsx(le,{className:"h-4 w-4"})})]})]},s.id)})}),N.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(F,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Files Found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:i.searchQuery?`No files match "${i.searchQuery}"`:"This folder is empty"}),!i.searchQuery&&e.jsxs(v,{htmlFor:"file-upload-empty",className:"cursor-pointer",children:[e.jsx(x,{id:"file-upload-empty",type:"file",multiple:!0,onChange:z,className:"hidden"}),e.jsx(n,{variant:"outline",asChild:!0,children:e.jsxs("span",{children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Upload Files"]})})]})]})]})]})})}function ye(){const c=se(),h=()=>{c("/admin/themes")};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(n,{variant:"outline",size:"sm",onClick:h,children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Back to Themes"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Theme Files"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage theme files and assets"})]})]}),e.jsx(ne,{})]})}export{ye as default};
