import{j as e}from"./ui-vendor-CzLWDOsI.js";import{r as o}from"./react-vendor-92AQlTAG.js";import{h as S,C as b,d as L,a6 as k,B as D,L as r,I as l,f as x}from"./index-CA1Fui7q.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=S("Locate",[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}]]);function G({onLocationSelect:w,initialLocation:C,value:d}){const y=C||(d?{lat:d.latitude,lng:d.longitude}:{lat:-6.2088,lng:106.8456}),[c,v]=o.useState(y),[s,E]=o.useState(d||{latitude:y.lat,longitude:y.lng,city:"",district:"",subdistrict:"",village:"",municipality:"",province:"",country:"",address:""}),[f,m]=o.useState(!1),[N,O]=o.useState(!1),h=async(a,i)=>{m(!0);try{const u=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${a}&lon=${i}&zoom=18&addressdetails=1`)).json();if(u&&u.address){const t=u.address,p={latitude:a,longitude:i,city:t.city||t.town||t.municipality||"",district:t.city_district||t.district||"",subdistrict:t.suburb||t.neighbourhood||"",village:t.village||t.hamlet||"",municipality:t.municipality||t.county||"",province:t.state||t.province||"",country:t.country||"",address:u.display_name||""};E(p),w(p),x.success("Location updated successfully!")}}catch(n){console.error("Error fetching location:",n),x.error("Failed to fetch location details")}finally{m(!1)}},M=()=>{navigator.geolocation?(m(!0),navigator.geolocation.getCurrentPosition(a=>{const{latitude:i,longitude:n}=a.coords;v({lat:i,lng:n}),h(i,n)},a=>{console.error("Error getting location:",a),x.error("Unable to get your location. Please enable location access."),m(!1)})):x.error("Geolocation is not supported by your browser")};return o.useEffect(()=>{d||h(c.lat,c.lng),O(!0)},[]),o.useEffect(()=>{if(!N)return;const a=document.createElement("link");a.rel="stylesheet",a.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",document.head.appendChild(a);const i=document.createElement("script");i.src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js",i.async=!0,i.onload=()=>{const n=window.L;if(!n||!document.getElementById("map-container"))return;const t=n.map("map-container").setView([c.lat,c.lng],15);n.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"Â© OpenStreetMap contributors"}).addTo(t);let p=n.marker([c.lat,c.lng]).addTo(t);return t.on("click",P=>{const{lat:g,lng:j}=P.latlng;p.setLatLng([g,j]),v({lat:g,lng:j}),h(g,j)}),()=>{t.remove()}},document.head.appendChild(i)},[N]),e.jsxs("div",{className:"space-y-4",children:[e.jsx(b,{children:e.jsxs(L,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"w-5 h-5 text-primary"}),e.jsx("h3",{className:"font-semibold",children:"Select Location on Map"})]}),e.jsxs(D,{type:"button",variant:"outline",size:"sm",onClick:M,disabled:f,children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Use My Location"]})]}),e.jsx("div",{id:"map-container",className:"rounded-lg overflow-hidden border-2 border-border",style:{height:"400px",width:"100%"}}),f&&e.jsx("div",{className:"mt-4 text-center text-sm text-muted-foreground",children:"Loading location details..."})]})}),e.jsx(b,{children:e.jsxs(L,{className:"p-4 space-y-4",children:[e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(k,{className:"w-4 h-4"}),"Location Details"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Latitude"}),e.jsx(l,{value:s.latitude.toFixed(6),readOnly:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Longitude"}),e.jsx(l,{value:s.longitude.toFixed(6),readOnly:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Village/Kelurahan"}),e.jsx(l,{value:s.village,readOnly:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Subdistrict/Kecamatan"}),e.jsx(l,{value:s.subdistrict,readOnly:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"District"}),e.jsx(l,{value:s.district,readOnly:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"City/Municipality"}),e.jsx(l,{value:s.city||s.municipality,readOnly:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Province"}),e.jsx(l,{value:s.province,readOnly:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Country"}),e.jsx(l,{value:s.country,readOnly:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Full Address"}),e.jsx(l,{value:s.address,readOnly:!0,className:"text-sm"})]})]})})]})}export{G as M};
