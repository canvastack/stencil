import{j as e}from"./ui-vendor-CzLWDOsI.js";import{r as v}from"./react-vendor-92AQlTAG.js";import{B as p,P as L,C as b,a as S,b as y,g as F,d as E,L as M,I as k,al as n,X as R,T as O,E as z,f as j,a3 as U,z as $,F as X,G as V,H}from"./index-CA1Fui7q.js";import{U as T}from"./upload-DcuZlmhL.js";import{C as W,P as q,E as B,a as Y,O as Z,u as J,D as K,T as Q}from"./three-vendor-CaHj5NkI.js";import{T as ee,a as se,b as A,c as I}from"./tabs-CEpnL4G3.js";const ae=({onSubmit:c,onPreview:o})=>{const[d,m]=v.useState([{id:"1",title:"",images:[]}]),f=()=>{const s=Date.now().toString();m(a=>[...a,{id:s,title:"",images:[]}])},N=s=>{d.length>1&&m(a=>a.filter(r=>r.id!==s))},D=(s,a,r)=>{m(t=>t.map(i=>i.id===s?{...i,[a]:r}:i))},C=(s,a)=>{if(!a)return;const r=d.find(h=>h.id===s);if(!r)return;const t=n.MAX_IMAGES_PER_SET-r.images.length,i=Array.from(a).slice(0,t);if(i.length===0){j.error(`Maximum ${n.MAX_IMAGES_PER_SET} images per set`);return}const x=i.map(h=>({file:h,preview:URL.createObjectURL(h),caption:""}));m(h=>h.map(g=>g.id===s?{...g,images:[...g.images,...x]}:g))},P=(s,a)=>{m(r=>r.map(t=>{var i;if(t.id===s){const x=t.images.filter((h,g)=>g!==a);return(i=t.images[a])!=null&&i.preview&&URL.revokeObjectURL(t.images[a].preview),{...t,images:x}}return t}))},l=(s,a,r)=>{m(t=>t.map(i=>i.id===s?{...i,images:i.images.map((x,h)=>h===a?{...x,caption:r}:x)}:i))},_=()=>{for(const s of d){if(!s.title.trim())return j.error("All titles are required"),!1;if(s.images.length===0)return j.error("Each set must have at least one image"),!1;for(const a of s.images){if(a.file.size>n.MAX_FILE_SIZE)return j.error(`File size must be less than ${n.MAX_FILE_SIZE/(1024*1024)}MB`),!1;if(!n.ALLOWED_IMAGE_TYPES.includes(a.file.type))return j.error("Only JPEG, PNG, and WebP files are allowed"),!1}}return!0},u=()=>{_()&&(c==null||c(d))},w=()=>{_()&&(o==null||o(d))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"3D Product Viewer Configuration"}),e.jsx("p",{className:"text-muted-foreground",children:"Configure multiple image sets for 3D product visualization"})]}),e.jsxs(p,{onClick:f,className:"gap-2",children:[e.jsx(L,{className:"w-4 h-4"}),"Add Set"]})]}),e.jsx("div",{className:"space-y-6",children:d.map((s,a)=>e.jsxs(b,{className:"relative",children:[e.jsxs(S,{className:"flex flex-row items-center justify-between",children:[e.jsxs(y,{className:"text-lg",children:["Set ",a+1]}),d.length>1&&e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>N(s.id),className:"text-destructive hover:text-destructive",children:e.jsx(F,{className:"w-4 h-4"})})]}),e.jsxs(E,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:`title-${s.id}`,children:"Title *"}),e.jsx(k,{id:`title-${s.id}`,placeholder:"Enter set title (e.g., Front View, Side View)",value:s.title,onChange:r=>D(s.id,"title",r.target.value)})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(M,{children:["3D Images (",s.images.length,"/",n.MAX_IMAGES_PER_SET,")"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",multiple:!0,accept:n.ALLOWED_IMAGE_TYPES.join(","),onChange:r=>C(s.id,r.target.files),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",disabled:s.images.length>=n.MAX_IMAGES_PER_SET}),e.jsxs(p,{type:"button",variant:"outline",size:"sm",disabled:s.images.length>=n.MAX_IMAGES_PER_SET,className:"gap-2",children:[e.jsx(T,{className:"w-4 h-4"}),"Upload Images"]})]})]}),s.images.length>0&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:s.images.map((r,t)=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:r.preview,alt:`Preview ${t+1}`,className:"w-full h-24 object-cover rounded-lg border"}),e.jsx(p,{type:"button",variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 w-6 h-6 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>P(s.id,t),children:e.jsx(R,{className:"w-3 h-3"})})]}),e.jsx(O,{placeholder:"Image caption (optional)",value:r.caption,onChange:i=>l(s.id,t,i.target.value),className:"text-xs min-h-[60px] resize-none"})]},t))})]})]})]},s.id))}),e.jsxs("div",{className:"flex gap-4 pt-6 border-t",children:[e.jsxs(p,{onClick:w,variant:"outline",className:"gap-2",children:[e.jsx(z,{className:"w-4 h-4"}),"Preview 3D View"]}),e.jsxs(p,{onClick:u,className:"gap-2",children:[e.jsx(T,{className:"w-4 h-4"}),"Save Configuration"]})]})]})};function re({imageUrl:c}){const o=c?J(Q,c):null;return e.jsxs("group",{children:[e.jsxs("mesh",{castShadow:!0,receiveShadow:!0,children:[e.jsx("planeGeometry",{args:[3,2]}),e.jsx("meshStandardMaterial",{map:o,color:o?"#ffffff":"#cccccc",metalness:.1,roughness:.3,side:K})]}),e.jsxs("mesh",{position:[0,1.05,-.02],children:[e.jsx("boxGeometry",{args:[3.2,.1,.05]}),e.jsx("meshStandardMaterial",{color:"#d4af37",metalness:.8,roughness:.2})]}),e.jsxs("mesh",{position:[0,-1.05,-.02],children:[e.jsx("boxGeometry",{args:[3.2,.1,.05]}),e.jsx("meshStandardMaterial",{color:"#d4af37",metalness:.8,roughness:.2})]}),e.jsxs("mesh",{position:[-1.55,0,-.02],children:[e.jsx("boxGeometry",{args:[.1,2.2,.05]}),e.jsx("meshStandardMaterial",{color:"#d4af37",metalness:.8,roughness:.2})]}),e.jsxs("mesh",{position:[1.55,0,-.02],children:[e.jsx("boxGeometry",{args:[.1,2.2,.05]}),e.jsx("meshStandardMaterial",{color:"#d4af37",metalness:.8,roughness:.2})]}),e.jsxs("mesh",{position:[0,0,-.08],receiveShadow:!0,children:[e.jsx("boxGeometry",{args:[3.2,2.2,.1]}),e.jsx("meshStandardMaterial",{color:"#2a2a2a",metalness:.5,roughness:.5})]}),e.jsxs("mesh",{position:[0,-1.4,-.3],rotation:[0,0,0],children:[e.jsx("boxGeometry",{args:[3.4,.2,.6]}),e.jsx("meshStandardMaterial",{color:"#1a1a1a",metalness:.6,roughness:.4})]})]})}function te(){return e.jsxs("mesh",{children:[e.jsx("boxGeometry",{args:[1,1,1]}),e.jsx("meshStandardMaterial",{color:"#888",wireframe:!0})]})}function G({productType:c="plaque",imageUrl:o}){return e.jsxs("div",{className:`w-full h-[${n.VIEWER_HEIGHT}px] rounded-lg overflow-hidden bg-gradient-to-b from-background to-muted`,children:[e.jsxs(W,{shadows:!0,children:[e.jsx(q,{makeDefault:!0,position:[0,0,5]}),e.jsx("ambientLight",{intensity:.5}),e.jsx("directionalLight",{position:[10,10,5],intensity:1,castShadow:!0,"shadow-mapSize-width":2048,"shadow-mapSize-height":2048}),e.jsx("spotLight",{position:[-10,10,-5],intensity:.5,angle:.3,penumbra:1,castShadow:!0}),e.jsxs(v.Suspense,{fallback:e.jsx(te,{}),children:[e.jsx(re,{imageUrl:o}),e.jsx(B,{preset:"studio"}),e.jsx(Y,{position:[0,-1.7,0],opacity:.5,scale:10,blur:2,far:4})]}),e.jsx(Z,{enableDamping:!0,dampingFactor:.05,minDistance:n.MIN_DISTANCE,maxDistance:n.MAX_DISTANCE,maxPolarAngle:Math.PI/1.8,autoRotate:!0,autoRotateSpeed:n.AUTO_ROTATE_SPEED})]}),e.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 bg-background/80 backdrop-blur-sm px-4 py-2 rounded-full text-xs text-muted-foreground",children:"Drag untuk rotasi • Scroll untuk zoom • Auto rotate aktif"})]})}function me(){const[c,o]=v.useState([]),[d,m]=v.useState(!1),[f,N]=v.useState(""),D=l=>{o(l),j.success("3D configuration saved successfully!")},C=l=>{o(l),l.length>0&&l[0].images.length>0&&(N(l[0].images[0].preview),m(!0))},P=l=>{N(l)};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(U,{className:"w-8 h-8 text-primary"}),"3D Product Manager"]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Configure and manage 3D product visualizations"})]})}),e.jsxs(ee,{defaultValue:"configure",className:"space-y-6",children:[e.jsxs(se,{className:"grid w-full grid-cols-2",children:[e.jsx(A,{value:"configure",children:"Configure 3D Sets"}),e.jsx(A,{value:"preview",children:"3D Preview"})]}),e.jsx(I,{value:"configure",className:"space-y-6",children:e.jsxs(b,{children:[e.jsx(S,{children:e.jsx(y,{children:"3D Configuration Form"})}),e.jsx(E,{children:e.jsx(ae,{onSubmit:D,onPreview:C})})]})}),e.jsx(I,{value:"preview",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(b,{children:[e.jsx(S,{children:e.jsx(y,{children:"3D Product Viewer"})}),e.jsx(E,{children:e.jsx(G,{imageUrl:f})})]}),e.jsxs(b,{children:[e.jsx(S,{children:e.jsx(y,{children:"Image Gallery"})}),e.jsx(E,{children:c.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No images configured yet. Please configure 3D sets first."}):e.jsx("div",{className:"space-y-6",children:c.map((l,_)=>e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-semibold text-lg",children:l.title}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:l.images.map((u,w)=>e.jsxs("div",{className:`relative cursor-pointer rounded-lg overflow-hidden border-2 transition-all ${f===u.preview?"border-primary shadow-lg":"border-muted hover:border-primary/50"}`,onClick:()=>P(u.preview),children:[e.jsx("img",{src:u.preview,alt:`${l.title} - ${u.caption||`Image ${w+1}`}`,className:"w-full h-24 object-cover"}),u.caption&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black/70 text-white text-xs p-1",children:u.caption})]},w))})]},l.id))})})]})]})})]}),e.jsx($,{open:d,onOpenChange:m,children:e.jsxs(X,{className:"max-w-4xl",children:[e.jsx(V,{children:e.jsx(H,{children:"3D Product Preview"})}),e.jsx("div",{className:"aspect-video",children:e.jsx(G,{imageUrl:f})})]})})]})}export{me as default};
